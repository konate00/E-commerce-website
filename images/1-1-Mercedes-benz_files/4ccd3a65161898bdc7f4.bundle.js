"use strict";(self.webpackChunk_mbusa_now_aem=self.webpackChunk_mbusa_now_aem||[]).push([[9543],{99543:function(e,t,n){n.d(t,{Z:function(){return re}});var i=n(42982),o=n(15671),r=n(43144),a=n(47755),s=n(4942),l=n(61156),c=n(48218),h=n(30168);function d(){var e=(0,h.Z)(['\n    <div class="promo-reservation-form__eligibility-content">\n        <p class="promo-reservation-form__copy">','</p>\n        <div class="promo-reservation-form__zip-code-wrapper">\n            <button class="button button_primary promo-reservation-form__zip-code-search-btn" data-analytics-trigger="reserve-dealer-search">',"</button>\n        </div>\n    </div>\n"]);return d=function(){return e},e}var u=window.mbNafta.applicationProperties.dealerLocatorService,m=window.mbNafta.pageData.country;function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var v={zipCodePrompt:"Enter your Atlanta area ZIP code to check your eligibility and find a participating dealer.",zipCodeLabel:"Enter Zip Code",zipCodeSearchLabel:"Search",invalidZipcode:"Please enter a valid zip code."},f=function(){function e(t,n){var i,r,a;(0,o.Z)(this,e),this.localization=Object.assign(v,window.mbNafta.ns("pageData").localization),this.content=t,this.config=n,this.element=(i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.localization),r=i.zipCodePrompt,a=i.zipCodeSearchLabel,(0,l.e2)(d(),r,a))({getNode:!0}),this.init()}return(0,r.Z)(e,[{key:"init",value:function(){this.cacheDOM(),this.setBindings(),this.createInputs(),this.attachEvents()}},{key:"cacheDOM",value:function(){this.inputZipCodeElm=this.element.querySelector(".".concat("promo-reservation-form__zip-code-wrapper")),this.buttonZipCodeSearch=this.element.querySelector(".".concat("promo-reservation-form__zip-code-search-btn"))}},{key:"setBindings",value:function(){this.onKeyUpZipcode=this.onKeyUpZipcode.bind(this),this.onZipCodeSearch=this.onZipCodeSearch.bind(this)}},{key:"createInputs",value:function(){this.inputs={zipCode:new a.O8({type:"text",required:!0,labelText:this.localization.zipCodeLabel,maxLength:10,inputClassNames:["promo-reservation-form__zip-code"],validation:[{type:a.O8.VALIDATION_TYPE.REQUIRED,errorMessage:this.localization.invalidZipcode},{type:a.O8.VALIDATION_TYPE.ZIP_CODE,errorMessage:this.localization.invalidZipcode}],restrictions:[a.O8.RESTRICTION_TYPE.ALPHA_NUMERIC],onKeyupCallback:this.onKeyUpZipcode})},l.jG.prepend(this.inputs.zipCode.render(),this.inputZipCodeElm)}},{key:"attachEvents",value:function(){this.buttonZipCodeSearch.addEventListener(c.FP.CLICK,this.onZipCodeSearch)}},{key:"onZipCodeSearch",value:function(){this.findDealers()}},{key:"onKeyUpZipcode",value:function(e){13===e.keyCode&&this.findDealers()}},{key:"findDealers",value:function(){var e,t,n,i=this;if(this.inputs.zipCode.validate()){var o=this.inputs.zipCode.getValue();(e=o,t=this.content.promoIdentifier,n=(0,l.HD)({zip:e,campaignId:t}),fetch("".concat(u,"/").concat(m,"/dealers").concat(n),{headers:{"Content-Type":"application/json","Referrer-Policy":"origin",Referer:window.location.href},method:"GET"}).then((function(e){return e.json()})).then((function(e){if(404===e.status.code)throw Error(e.status.description);return 200===e.status.code?(t=e,Array.isArray(t.dealers)?t.dealers.map((function(e){var t=e.address[0],n=t.city,i=t.line1,o=t.line2,r=t.zip,a=t.location,s=t.state,l=Array.isArray(e.contact)?e.contact.filter((function(e){return"phone"===e.type.toLowerCase()}))[0].value:"";return{name:e.name,id:e.id,address:{line1:i,line2:o,city:n,state:s,zip:r},phone:l,location:{lat:a.lat,lng:a.lng},distance:Number(a.dist).toFixed(1)}})):null):null;var t}))).then((function(e){i.config.onSearchResults(e,o)})).catch((function(e){i.config.onSearchError(e)}))}}},{key:"detachEvents",value:function(){this.buttonZipCodeSearch.removeEventListener(c.FP.CLICK,this.onZipCodeSearch)}},{key:"render",value:function(){return this.element}},{key:"destroy",value:function(){this.detachEvents(),this.inputs.zipCode.destroy(),this.inputs.zipCode=null,this.element.remove()}}]),e}();function g(){var e=(0,h.Z)(['\n                <li class="promo-reservation-form__dealer-list-item">\n                    <button class="promo-reservation-form__dealer-list-item-btn" data-dealer-id="','">\n                        ','\n                        <span class="promo-reservation-form__dealer-address-container">\n                            <span class="promo-reservation-form__dealer-info">\n                                <h4 class="promo-reservation-form__dealer-name">','</h4>\n                                <address class="promo-reservation-form__dealer-address">','</address>\n                            </span>\n                        </span>\n                        <span class="promo-reservation-form__dealer-proximity">\n                            <span class="promo-reservation-form__dealer-proximity-value">',"</span>\n                            ","\n                        </span>\n                    </button>\n                </li>\n            "]);return g=function(){return e},e}function y(){var e=(0,h.Z)(['\n    <div class="promo-reservation-form__eligibility-content">\n        <p class="promo-reservation-form__copy">','</p>\n        <p class="promo-reservation-form__copy"><button class="link link_plain-link promo-reservation-form__change-location-link">','</button></p>\n        <ul class="promo-reservation-form__dealer-list">\n            ','\n        </ul>\n        <div class="promo-reservation-form__dealer-error-wrapper">\n            <span class="form__input-error promo-reservation-form__dealer-error">',"</span>\n        </div>\n    </div>\n"]);return y=function(){return e},e}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var _={changeLocationLabel:"Change Location",suggestedLabel:"Suggested",searchResultsPrompt:"Choose a dealer near {0} where you'd like to pick up your {1}.",milesAbbreviation:"mi",dealerUnselectedError:"Please select a dealer to continue."},E=function(){function e(t,n){(0,o.Z)(this,e),this.localization=Object.assign(_,window.mbNafta.ns("pageData").localization),this.content=t,this.config=n,this.init()}return(0,r.Z)(e,[{key:"init",value:function(){this.createView(),this.cacheDOM(),this.setBindings(),this.attachEvents()}},{key:"createView",value:function(){var e=(0,l.NR)(this.localization.searchResultsPrompt,[this.content.zipcode,this.content.modelName]);this.element=function(e){var t=e.changeLocationLabel,n=e.dealerUnselectedError,i=e.suggestedLabel,o=e.searchResultsPrompt,r=e.milesAbbreviation,a=e.results;return(0,l.e2)(y(),o,t,a.map((function(e,t){return(0,l.dy)(g(),e.id,0===t?'<span class="promo-reservation-form__suggested-dealer">'.concat(i,"</span>"):"",e.name,"".concat(e.address.line1,", ").concat(e.address.city,", ").concat(e.address.state," ").concat(e.address.zip),e.distance,r)})).join(""),n)}(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.localization,{searchResultsPrompt:e},this.content))({getNode:!0})}},{key:"cacheDOM",value:function(){this.dealershipItems=this.element.querySelectorAll(".".concat("promo-reservation-form__dealer-list-item-btn")),this.changeLocationLink=this.element.querySelector(".".concat("promo-reservation-form__change-location-link"))}},{key:"setBindings",value:function(){this.onChangeLocation=this.onChangeLocation.bind(this),this.onDealershipListItemSelect=this.onDealershipListItemSelect.bind(this)}},{key:"attachEvents",value:function(){var e=this;this.changeLocationLink.addEventListener(c.FP.CLICK,this.onChangeLocation),[].slice.call(this.dealershipItems).forEach((function(t){t.addEventListener(c.FP.CLICK,e.onDealershipListItemSelect)}))}},{key:"detachEvents",value:function(){var e=this;this.changeLocationLink.removeEventListener(c.FP.CLICK,this.onChangeLocation),[].slice.call(this.dealershipItems).forEach((function(t){t.removeEventListener(c.FP.CLICK,e.onDealershipListItemSelect)}))}},{key:"onChangeLocation",value:function(){this.config.onLocationChangeRequest()}},{key:"onDealershipListItemSelect",value:function(e){var t=this.content.results.filter((function(t){return t.id===e.currentTarget.dataset.dealerId}));this.config.onDealershipSelect(t[0])}},{key:"render",value:function(){return this.element}},{key:"destroy",value:function(){this.detachEvents(),this.element.remove()}}]),e}();function w(){var e=(0,h.Z)(['\n    <div class="promo-reservation-form__eligibility-content promo-reservation-form__eligibility-selected-dealer">\n        <div class="promo-reservation-form__selected-dealer" tabindex="-1">\n            <p class="promo-reservation-form__selected-dealer-copy">','</p>\n            <h4 class="promo-reservation-form__dealer-name">','</h4>\n            <address class="promo-reservation-form__dealer-address">','</address>\n        </div>\n        <button class="promo-reservation-form__change-dealer-btn">',"</button>\n    </div>\n"]);return w=function(){return e},e}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var S={selectedDealerPrompt:"Thanks, your selected dealer is:",changeDealerLabel:"Change Dealer"},C=function(){function e(t,n){var i,r,a,c;(0,o.Z)(this,e),this.localization=Object.assign(S,window.mbNafta.ns("pageData").localization),this.content=t,this.config=n,this.element=(i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.localization,{},this.content),r=i.selectedDealerPrompt,a=i.dealer,c=i.changeDealerLabel,(0,l.e2)(w(),r,a.name,"".concat(a.address.line1,", ").concat(a.address.city,", ").concat(a.address.state," ").concat(a.address.zip,'<br/><a href="tel:').concat(a.phone,'" class="link link_plain-link">').concat(a.phone,"</a>"),c))({getNode:!0}),this.init()}return(0,r.Z)(e,[{key:"init",value:function(){this.cacheDOM(),this.setBindings(),this.attachEvents()}},{key:"cacheDOM",value:function(){this.buttonChangeDealer=this.element.querySelector(".".concat("promo-reservation-form__change-dealer-btn"))}},{key:"setBindings",value:function(){this.onDealerChange=this.onDealerChange.bind(this)}},{key:"attachEvents",value:function(){this.buttonChangeDealer.addEventListener(c.FP.CLICK,this.onDealerChange)}},{key:"onDealerChange",value:function(){this.config.onDealerChangeRequest()}},{key:"detachEvents",value:function(){this.buttonChangeDealer.removeEventListener(c.FP.CLICK,this.onDealerChange)}},{key:"render",value:function(){return this.element}},{key:"destroy",value:function(){this.detachEvents(),this.element.remove()}}]),e}();function I(){var e=(0,h.Z)(['\n    <div class="promo-reservation-form__eligibility-content promo-reservation-form__eligibility-user-ineligible">\n        <div class="promo-reservation-form__user-ineligible" tabindex="-1">\n            <p class="promo-reservation-form__user-ineligible-message">','</p>\n            <p class="promo-reservation-form__user-ineligible-details">','</p>\n            <div class="promo-reservation-form__contact-dealer">\n                <a href="/mercedes/contact_us/dealer" class="button button_primary">','</a>\n            </div>\n            <div class="promo-reservation-form__change-zipcode">\n                <button class="link link_plain-link promo-reservation-form__change-zipcode-btn">',"</button>\n            </div>\n        </div>\n    </div>\n"]);return I=function(){return e},e}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}var P={ineligibleMessage:"Sorry, this offer is not available in your area.",eligibilityDescription:"The Mercedez-Benz Flexible Lease Program is currently only available in the greater Atlanta area. To explore more A-Class offers, please contact a dealer near you.",contactDealerLabel:"Contact a Dealer",changeZipcodeLabel:"Change ZIP Code"},D=function(){function e(t,n){var i,r,a,c,h;(0,o.Z)(this,e),this.localization=Object.assign(P,window.mbNafta.ns("pageData").localization),this.content=t,this.config=n,this.element=(i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.localization,{},this.content),r=i.ineligibleMessage,a=i.eligibilityDescription,c=i.contactDealerLabel,h=i.changeZipcodeLabel,(0,l.e2)(I(),r,a,c,h))({getNode:!0}),this.init()}return(0,r.Z)(e,[{key:"init",value:function(){this.cacheDOM(),this.setBindings(),this.attachEvents()}},{key:"cacheDOM",value:function(){this.buttonChangeLocation=this.element.querySelector(".".concat("promo-reservation-form__change-zipcode-btn"))}},{key:"setBindings",value:function(){this.onChangeLocation=this.onChangeLocation.bind(this)}},{key:"attachEvents",value:function(){this.buttonChangeLocation.addEventListener(c.FP.CLICK,this.onChangeLocation)}},{key:"detachEvents",value:function(){this.buttonChangeLocation.removeEventListener(c.FP.CLICK,this.onChangeLocation)}},{key:"onChangeLocation",value:function(){this.config.onLocationChangeRequest()}},{key:"render",value:function(){return this.element}},{key:"destroy",value:function(){this.detachEvents(),this.element.remove()}}]),e}(),L="search",R="searchResults",N="userIneligible",T="dealershipSelected",V=[".title-hero__sub-heading",".promo-reservation-form__vehicle-details",".promo-reservation-form__heading--eligibility",".promo-reservation-form__personal-info",".promo-reservation-form__payment"],z=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.Z)(this,e),this.element=t,this.config=n,this.activeView=null,this.init()}return(0,r.Z)(e,[{key:"init",value:function(){var e;this.setBindings(),this.views=(e={},(0,s.Z)(e,L,{config:{onSearchResults:this.onSearchResults,onSearchError:this.onSearchError},content:{promoIdentifier:window.mbNafta.pageData.promoReservation.promoIdentifier}}),(0,s.Z)(e,R,{config:{onDealershipSelect:this.onDealershipSelect,onLocationChangeRequest:this.onLocationChangeRequest},content:{modelName:window.mbNafta.pageData.promoReservation.modelName,results:null}}),(0,s.Z)(e,T,{config:{onDealerChangeRequest:this.onDealerChangeRequest},content:{dealer:null},focusElement:".promo-reservation-form__selected-dealer"}),(0,s.Z)(e,N,{config:{onLocationChangeRequest:this.onLocationChangeRequest},content:{},focusElement:".promo-reservation-form__user-ineligible"}),e),this.createView(L,this.views[L])}},{key:"setBindings",value:function(){this.onSearchResults=this.onSearchResults.bind(this),this.onLocationChangeRequest=this.onLocationChangeRequest.bind(this),this.onDealershipSelect=this.onDealershipSelect.bind(this),this.onDealerChangeRequest=this.onDealerChangeRequest.bind(this),this.onSearchError=this.onSearchError.bind(this)}},{key:"createView",value:function(e,t){switch(this.activeView&&(this.activeView.destroy(),this.activeView=null),e){case L:this.activeView=new f(t.content,t.config),this.toggleDisplay(V,!0);break;case R:this.activeView=new E(t.content,t.config);break;case T:this.activeView=new C(t.content,t.config);break;case N:this.activeView=new D(t.content,t.config),this.toggleDisplay(V,!1)}l.jG.append(this.activeView.render(),this.element),t.focusElement&&this.activeView.element.querySelector(t.focusElement).focus()}},{key:"onSearchResults",value:function(e,t){this.views[R].content.results=e,this.views[R].content.zipcode=t,this.createView(R,this.views[R]),this.config.onZipcodeValidated(t)}},{key:"onLocationChangeRequest",value:function(){this.createView(L,this.views[L]),this.element.querySelector(".promo-reservation-form__zip-code > input").focus(),this.config.onZipcodeValidated(null)}},{key:"onDealershipSelect",value:function(e){this.views[T].content.dealer=e,this.createView(T,this.views[T]),this.config.onDealershipSelect(e.id,e.name)}},{key:"onDealerChangeRequest",value:function(){this.createView(R,this.views[R]),this.config.onDealershipSelect(null,null)}},{key:"onSearchError",value:function(){this.createView(N,this.views[N]),this.config.onUserIneligible()}},{key:"toggleDisplay",value:function(){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(t){var n=document.querySelector(t);n&&(e?n.dataset.display&&(n.style.display=n.dataset.display,delete n.dataset.display):(n.dataset.display=window.getComputedStyle(n).display,n.style.display="none"))}))}},{key:"render",value:function(){return this.element}}]),e}();function j(){var e=(0,h.Z)(['\n                <li role="tab" class="promo-reservation-form__color-selector-item-wrapper" aria-selected="','">\n                    <button class="promo-reservation-form__color-selector-item ','"\n                        data-value="','"\n                        aria-label="','"\n                        data-analytics-trigger="reserve-color-select">\n                        <picture>\n                            <source media="(max-width: 767px)" srcset="','">\n                            <source media="(min-width: 768px)" srcset="','">\n                            <img class="responsive-image promo-reservation-form__color-selector-item-image" src="','" role="presentation" />\n                        </picture>\n                    </button>\n                </li>\n            ']);return j=function(){return e},e}function Z(){var e=(0,h.Z)(['\n    <div class="promo-reservation-form__color-selector-wrapper">\n        <p class="promo-reservation-form__color-selector-selected-label">','</p>\n        <ul class="promo-reservation-form__color-selector-swatches" role="tablist">\n            ',"\n        </ul>\n    </div>\n"]);return Z=function(){return e},e}var A="promo-reservation-form__color-selector-item--selected",M=function(){function e(t,n){var i=n.element,r=n.defaultSelection,a=void 0===r?0:r,s=n.selectionCallback,c=void 0===s?l.ZT:s;(0,o.Z)(this,e),this.config=Object.assign({element:i,items:t,defaultSelection:a,selectionCallback:c},{}),this.init()}return(0,r.Z)(e,[{key:"init",value:function(){this.modelColorSelector||(this.createView(),l.jG.append(this.modelColorSelector,this.config.element)),this.cacheDOM(),this.setBindings(),this.attachEvents()}},{key:"setBindings",value:function(){this.onSelectItem=this.onSelectItem.bind(this)}},{key:"createView",value:function(){var e,t,n,i,o;this.modelColorSelector=(n=void 0===(t=(e=this.config).items)?[]:t,i=e.defaultSelection,o=void 0===i?-1:i,(0,l.e2)(Z(),n[o].label,n.map((function(e,t){return(0,l.dy)(j(),t===o,t===o?"promo-reservation-form__color-selector-item--selected":"",e.value,e.label,e.swatchImageSmall||e.swatchImageLarge,e.swatchImageLarge||e.swatchImageSmall,e.swatchImageLarge||e.swatchImageSmall)})).join("")))({getNode:!0})}},{key:"cacheDOM",value:function(){this.colorSwatchItems=(0,i.Z)(this.modelColorSelector.querySelectorAll(".".concat("promo-reservation-form__color-selector-item"))),this.selectedLabel=this.modelColorSelector.querySelector(".".concat("promo-reservation-form__color-selector-selected-label"))}},{key:"attachEvents",value:function(){var e=this;this.colorSwatchItems.forEach((function(t){return t.addEventListener(c.FP.CLICK,e.onSelectItem)}))}},{key:"detachEvents",value:function(){var e=this;this.colorSwatchItems.forEach((function(t){return t.removeEventListener(c.FP.CLICK,e.onSelectItem)}))}},{key:"onSelectItem",value:function(e){var t=this.config.items.find((function(t){return t.value===e.currentTarget.dataset.value}));this.colorSwatchItems.forEach((function(e){e.classList.remove(A),e.parentElement.setAttribute("aria-selected","false")})),e.currentTarget.classList.add(A),e.currentTarget.parentElement.setAttribute("aria-selected","true"),this.selectedLabel.innerText=t.label,this.config.selectionCallback(t.label,t.value)}},{key:"render",value:function(){return this.element}},{key:"destroy",value:function(){this.detachEvents(),this.element.remove()}}]),e}(),q=n(82051),U=n(83224);function F(){var e=(0,h.Z)(['\n    <picture class="promo-reservation-form__model-hero-picture">\n        <source media="(max-width: 767px)" srcset="','">\n        <source media="(min-width: 768px)" srcset="','">\n        <img class="responsive-image promo-reservation-form__model-hero-image" src="','" alt="','" />\n    </picture>\n']);return F=function(){return e},e}var x=function(){function e(t,n){(0,o.Z)(this,e),this.element=t,this.content=n,this.init()}return(0,r.Z)(e,[{key:"init",value:function(){this.modelHeroVehiclePictureElms=null,this.mediaServerApi=q.W.getInstance(),this.attachEvents(),this.getVehicleImages(),this.renderLoader()}},{key:"attachEvents",value:function(){var e=this;l.Jw.addEventListener(c.fD.UPDATE_EXTERIOR_COLOR,(function(t){e.onExteriorColorUpdate(t)}))}},{key:"onExteriorColorUpdate",value:function(e){e.detail.paintId&&(this.content.options.exterior.PAINT[0].id=e.detail.paintId,this.content.paint=e.detail.paintName,this.renderLoader(),this.getVehicleImages())}},{key:"renderLoader",value:function(){this.loader=new U.T,l.jG.append(this.loader.render(),this.element)}},{key:"getVehicleImages",value:function(){var e=this;this.mediaServerApi.getBuildImage(this.content,{view:q.W.VIEW_TYPES.EXTERIOR,pov:q.W.POV_TYPES.FRONT,presetCategory:q.W.PRESET_CATEGORIES.MODEL,type:"jpg",bkgnd:"white"}).then((function(t){e.getMediaServerType(),e.preloadImages(t.respObj)}))}},{key:"getMediaServerType",value:function(){var e=this;this.mediaServerApi.getMediaServerType({year:this.content.year,className:this.content.class,model:this.content.model}).then((function(t){t===q.W.MEDIA_SERVER_TYPES.BBD&&e.element.classList.add("promo-reservation-form__model-hero-vehicle--bbd")}))}},{key:"preloadImages",value:function(e){var t=this,n=new Image;n.onload=function(){n.onload=null,t.renderVehicle(e,n)},n.src=l.sp.getState().small?e.small.retina:e.large.retina}},{key:"renderVehicle",value:function(e,t){var n=null!=this.modelHeroVehiclePictureElms;l.jG.append(function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return(0,l.e2)(F(),t||e,e||t,n,i)}(e.large.retina,e.small.retina,t.src,"".concat(this.content.name," ").concat(this.content.paint))({getNode:!0}),this.element),this.loader.destroy(),this.modelHeroVehiclePictureElms=(0,i.Z)(this.element.querySelectorAll(".".concat("promo-reservation-form__model-hero-picture"))),n&&this.element.removeChild(this.modelHeroVehiclePictureElms.shift())}}]),e}(),B=window.mbNafta.pageData,H=B.country,W=B.promoReservation;var Y=n(85879),K={firstNameBlankError:"Please enter your first name",lastNameBlankError:"Please enter your last name",invalidEmail:"Please enter a valid email address",invalidPhoneNumber:"Please enter a valid phone number",serverErrorTitle:"We’re sorry, an error has occurred.",serverErrorDescription:"We were unable to process your request. Please try again.",validationError:"Please fix the information highlighted above",dealerUnselectedError:"Please select a dealer to continue."},G=function(){function e(t){(0,o.Z)(this,e),this.localization=Object.assign(K,window.mbNafta.ns("reservationPageData").localization),this.element=t,this.content={},this.init()}return(0,r.Z)(e,[{key:"init",value:function(){try{var e=JSON.parse(window.mbNafta.pageData.promoReservation.jsonString),t=e.activeModelMeta,n=e.interiorPaintOption,i=e.packageOption,o=e.paintOptions,r=e.wheelOption;this.content=Object.assign(this.content,{vehicle:{classId:t.model.vehicleClass.code.toLowerCase(),exteriorColor:o[0].id,interiorColor:n.id,modelId:t.model.code.toLowerCase(),packages:[i.id],wheels:r.id,year:t.model.year.toString(),price:t.model.msrp}})}catch(e){console.error(e)}this.setBindings(),this.cacheDOM(),this.createInputs(),this.createEligibility(),this.attachEvents()}},{key:"setBindings",value:function(){this.onDealershipSelect=this.onDealershipSelect.bind(this),this.onZipcodeValidated=this.onZipcodeValidated.bind(this),this.onUserIneligible=this.onUserIneligible.bind(this),this.onVehicleColorUpdate=this.onVehicleColorUpdate.bind(this),this.onSubmit=this.onSubmit.bind(this),this.onSubmitError=this.onSubmitError.bind(this),this.onValidationError=this.onValidationError.bind(this)}},{key:"attachEvents",value:function(){l.Jw.addEventListener(c.fD.UPDATE_EXTERIOR_COLOR,this.onVehicleColorUpdate),this.buttonSubmit.addEventListener(c.FP.CLICK,this.onSubmit)}},{key:"detachEvents",value:function(){l.Jw.removeEventListener(c.fD.UPDATE_EXTERIOR_COLOR,this.onVehicleColorUpdate),this.buttonSubmit.removeEventListener(c.FP.CLICK,this.onSubmit)}},{key:"cacheDOM",value:function(){this.inputFirstNameElm=this.element.querySelector(".".concat("personal-info-first-name")),this.inputLastNameElm=this.element.querySelector(".".concat("personal-info-last-name")),this.inputPhoneElm=this.element.querySelector(".".concat("personal-info-phone")),this.inputEmailElm=this.element.querySelector(".".concat("personal-info-email")),this.eligibilityContainerElm=this.element.querySelector(".".concat("promo-reservation-form__eligibility")),this.errorContainerElement=this.element.querySelector(".".concat("promo-reservation-form__error-message")),this.buttonSubmit=this.element.querySelector(".".concat("promo-reservation-form__submit"))}},{key:"createInputs",value:function(){this.personalInfoInputs={firstName:new a.O8({renderedInput:this.inputFirstNameElm,validation:[{type:a.O8.VALIDATION_TYPE.REQUIRED,errorMessage:this.localization.firstNameBlankError},{type:a.O8.VALIDATION_TYPE.MAX_LENGTH,errorMessage:this.localization.firstNameBlankError}],restrictions:[a.O8.RESTRICTION_TYPE.NUMERIC]}),lastName:new a.O8({renderedInput:this.inputLastNameElm,validation:[{type:a.O8.VALIDATION_TYPE.REQUIRED,errorMessage:this.localization.lastNameBlankError},{type:a.O8.VALIDATION_TYPE.MAX_LENGTH,errorMessage:this.localization.lastNameBlankError}],restrictions:[a.O8.RESTRICTION_TYPE.NUMERIC]}),phone:new a.O8({renderedInput:this.inputPhoneElm,validation:[{type:a.O8.VALIDATION_TYPE.REQUIRED,errorMessage:this.localization.invalidPhoneNumber},{type:a.O8.VALIDATION_TYPE.PHONE_FORMATTED,errorMessage:this.localization.invalidPhoneNumber}],formatting:[{type:a.O8.FORMAT_TYPE.PHONE}],restrictions:[a.O8.RESTRICTION_TYPE.PHONE_NUMBER]}),email:new a.O8({renderedInput:this.inputEmailElm,validation:[{type:a.O8.VALIDATION_TYPE.REQUIRED,errorMessage:this.localization.invalidEmail},{type:a.O8.VALIDATION_TYPE.MAX_LENGTH,errorMessage:this.localization.invalidEmail},{type:a.O8.VALIDATION_TYPE.EMAIL,errorMessage:this.localization.invalidEmail}],restrictions:[a.O8.RESTRICTION_TYPE.EMAIL_SPECIAL_CHARS]})}}},{key:"createEligibility",value:function(){this.eligibility=new z(this.eligibilityContainerElm,{onDealershipSelect:this.onDealershipSelect,onZipcodeValidated:this.onZipcodeValidated,onUserIneligible:this.onUserIneligible})}},{key:"validateForm",value:function(){var e=void 0!==this.content.zip&&null!==this.content.zip;if(e||(e=this.eligibility.activeView.inputs.zipCode.validate()),!this.content.dealerId&&e){var t=this.element.querySelector(".".concat("promo-reservation-form__dealer-error")),n=this.element.querySelector(".".concat("promo-reservation-form__zip-code"," > .").concat("form__input-error")),i=t||n;i&&(i.innerText=this.localization.dealerUnselectedError,i.style.display=this.content.dealerId?"none":"block")}return this.personalInfoInputs.firstName.validate(),this.personalInfoInputs.lastName.validate(),this.personalInfoInputs.phone.validate(),this.personalInfoInputs.email.validate(),this.content.zip&&this.content.dealerId&&this.personalInfoInputs.firstName.isValid()&&this.personalInfoInputs.lastName.isValid()&&this.personalInfoInputs.phone.isValid()&&this.personalInfoInputs.email.isValid()}},{key:"onUserIneligible",value:function(){this.serverError&&this.hideServerError(),this.validationError&&this.hideValidationError(),this.content.zip=null}},{key:"onZipcodeValidated",value:function(e){this.content.zip=e}},{key:"onDealershipSelect",value:function(e,t){this.content.dealerId=e,this.content.dealerName=t}},{key:"onVehicleColorUpdate",value:function(e){this.content.vehicle.exteriorColor=e.detail.paintId}},{key:"onSubmit",value:function(){if(this.validationError&&this.hideValidationError(),this.validateForm()){var e=this.personalInfoInputs.phone.getValue().replace(/\)|\(|-|( )/g,""),t=this.element.querySelector(".".concat("promo-reservation-form__model-hero-picture")),n=(0,i.Z)(t.querySelectorAll("source"));this.content.vehicle.imageUrl=n[n.length-1].getAttribute("srcset"),(o=window.mbNafta.pageData.promoReservation.promoIdentifier,r={dealerId:this.content.dealerId,dealerName:this.content.dealerName},a={webId:l.pR.getCookie("MBUSA_WEB_ID"),zip:this.content.zip,emailId:this.personalInfoInputs.email.getValue(),firstName:this.personalInfoInputs.firstName.getValue(),lastName:this.personalInfoInputs.lastName.getValue(),phoneNumber:e,preferredContactMethod:"email"},s=this.content.vehicle,c=Object.assign({currency:"USD",downPaymentAmount:parseInt(W.reservationFee,10),leaseTerm:parseInt(W.leaseTerm,10),leaseAmount:parseInt(W.monthlyPayment,10)},s),h="".concat(location.protocol,"//").concat(location.hostname).concat(""!==location.port?":".concat(location.port):"").concat(W.confirmationPath),d=Object.assign({callBackUrl:h},{campaignId:o,customer:a,dealer:r,vehicleDetail:c}),fetch("/content/public-api/forms/flex/submit?country=".concat(H),{headers:{"Content-Type":"application/json","Referrer-Policy":"origin",Referer:window.location.href},method:"POST",body:JSON.stringify(d)}).then((function(e){return e.json()})).then((function(e){if(e.success)return e;throw Error(e.error.errorDescription)}))).then(this.onSubmitSuccess).catch(this.onSubmitError)}else this.onValidationError();var o,r,a,s,c,h,d}},{key:"onSubmitSuccess",value:function(e){l.pR.setCookie({name:"mbusa_reservation_key",value:"".concat(e.invoiceId)}),window.location.assign("".concat(window.location.origin).concat(window.location.pathname.replace(".html",""),"/confirmation.html").concat(window.location.search))}},{key:"onSubmitError",value:function(){this.validationError&&this.hideValidationError(),this.showServerError()}},{key:"onValidationError",value:function(){this.serverError&&this.hideServerError(),this.showValidationError()}},{key:"showValidationError",value:function(){this.validationError||(this.validationError=new Y.Xq({description:this.localization.validationError})),this.validationError.show(this.errorContainerElement)}},{key:"hideValidationError",value:function(){this.validationError.hide()}},{key:"showServerError",value:function(){this.serverError||(this.serverError=new Y.Xq({title:this.localization.serverErrorTitle,description:this.localization.serverErrorDescription})),this.serverError.show(this.errorContainerElement)}},{key:"hideServerError",value:function(){this.serverError.hide()}}]),e}();function X(){var e=(0,h.Z)(['\n    <section class="promo-reservation-confirmation__success-section">\n        <h2 class="promo-reservation-confirmation__success-subheading">','</h2>\n        <section class="promo-reservation-form__model-hero"></section>\n        <section class="promo-reservation-form__packages">\n            <div class="promo-reservation-form__packages-interior-wheels">\n                <div class="promo-reservation-form__packages-content-wrapper">\n                    <ul class="promo-reservation-form__packages-interior-wheels-list">\n                        ',"\n                    </ul>\n                </div>\n            </div>\n            ",'\n        </section>\n    </section>\n    <section class="promo-reservation-confirmation__success-section">\n        <h2 class="promo-reservation-confirmation__success-subheading promo-reservation-confirmation__success-subheading--reservation-details">','</h2>\n        <div class="promo-reservation-confirmation__success-dealer">\n            <h3 class="promo-reservation-confirmation__success-copyheading">','</h3>\n            <h4 class="promo-reservation-form__success-dealer-name">','</h4>\n            <address class="promo-reservation-form__success-dealer-address">\n                <a class="link link_plain-link" href="//www.google.com/maps/dir/Current+Location/',",+",",+","",",+",",+",'" target="_blank">\n                    ',"<br/>","",", "," ",'\n                </a>\n            </address>\n        </div>\n        <div class="promo-reservation-confirmation__map-container">\n\n        </div>\n    </section>\n']);return X=function(){return e},e}var J=window.mbNafta.pageData.country;var Q=n(80662),$={yourSelectedVehicle:"Your Selected Vehicle",additionalFeatures:"Additional Features",reservationDetails:"Reservation Details",pickUpLocation:"Pick-Up Location",viewAllFeatures:"View All {0} Features",opensInNewTab:"Opens in a New Tab"},ee="promo-reservation-confirmation__initial-state",te="mbusa_reservation_key",ne=function(){function e(t){(0,o.Z)(this,e),this.element=t,this.localization=Object.assign($,window.mbNafta.ns("reservationPageData").localization),this.init()}return(0,r.Z)(e,[{key:"init",value:function(){this.setBindings(),this.cacheDOMElements(),this.requestPaymentStatus()}},{key:"setBindings",value:function(){this.setPageState=this.setPageState.bind(this),this.onRequestError=this.onRequestError.bind(this),this.onMapCreatedCallback=this.onMapCreatedCallback.bind(this)}},{key:"cacheDOMElements",value:function(){this.successWrapperElm=document.querySelector(".".concat("promo-reservation-confirmation--success")),this.errorWrapperElm=document.querySelector(".".concat("promo-reservation-confirmation--error")),this.loadingWrapperElm=document.querySelector(".".concat("promo-reservation-confirmation__loading")),this.initialStateElm=document.querySelector(".".concat(ee)),this.titleHeroElm=document.querySelector(".".concat("title-hero")),this.ctaBannerElm=document.querySelector(".".concat("cta-banner"))}},{key:"onRequestError",value:function(){this.renderRequestError(),l.pR.deleteCookie({name:te})}},{key:"requestPaymentStatus",value:function(){var e,t;(e=l.pR.getCookie(te),fetch("/content/public-api/forms/flex/status?country=".concat(J,"&invoiceId=").concat(e,"&webId=").concat(t),{headers:{"Content-Type":"application/json","Referrer-Policy":"origin",Referer:window.location.href},method:"GET"}).then((function(e){return e.json()})).then((function(e){if(e.success)return e;throw Error(e.status.message)}))).then(this.setPageState).catch(this.onRequestError)}},{key:"setPageState",value:function(e){"true"===e.success?this.renderPaymentSuccess(e):this.renderRequestError(),l.pR.deleteCookie({name:te})}},{key:"renderPaymentSuccess",value:function(e){this.dealer=e.dealer,this.localization.viewAllFeatures=(0,l.NR)(this.localization.viewAllFeatures,[e.vehicleDetail.modelName]),l.jG.prepend(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return(0,l.e2)(X(),n.yourSelectedVehicle,[e.paintOption,e.interiorPaintOption,e.wheelOption].map((function(e){return'\n                            <li class="promo-reservation-form__packages-interior-wheels-list-item">\n                                <div class="promo-reservation-form__packages-interior-wheels-list-item-image">\n                                    <picture class="promo-reservation-form__packages-picture">\n                                        <source media="(max-width: 767px)" srcset="'.concat(e.media[0].imgL,'">\n                                        <source media="(min-width: 768px)" srcset="').concat(e.media[0].imgL,'">\n                                        <img role="presentation" src="').concat(e.media[0].imgL,'" width="60" />\n                                    </picture>\n                                </div>\n                                <div class="promo-reservation-form__packages-interior-wheels-list-item-text">').concat(e.name,"</div>\n                            </li>\n                        ")})).join(""),e.packageOptions.length>0?'\n                <div class="promo-reservation-form__packages-additional-features">\n                    <div class="promo-reservation-form__packages-content-wrapper">\n                        <h4 class="promo-reservation-form__packages-title">'.concat(n.additionalFeatures,'</h4>\n                        <h5 class="promo-reservation-form__packages-title">').concat(e.packageOptions[0].name,'</h5>\n                        <ul class="promo-reservation-form__packages-additional-features-list">\n                            ').concat(e.packageOptions[0].packageOpts.map((function(e){return'<li class="promo-reservation-form__packages-additional-features-list-item">'.concat(e.option.name,"</li>")})).join(""),'\n                        </ul>\n                        <a href="').concat(e.modelPage,'#key-features" class="link link_plain-link link_external-link" data-analytics-trigger="cta" target="_blank" aria-label="').concat(n.viewAllFeatures," (").concat(n.opensInNewTab,')">').concat(n.viewAllFeatures,"</a>\n                    </div>\n                </div>"):"",n.reservationDetails,n.pickUpLocation,t.name,encodeURIComponent(t.name),encodeURIComponent(t.address[0].line1),""!==t.address[0].line2?"".concat(encodeURIComponent(t.address[0].line2),",+"):"",encodeURIComponent(t.address[0].city),t.address[0].state,t.address[0].zip,t.address[0].line1,""!==t.address[0].line2?"".concat(t.address[0].line2,"<br/>"):"",t.address[0].city,t.address[0].state,t.address[0].zip)}(e.vehicleDetail,e.dealer,this.localization)({getNode:!0}),this.successWrapperElm),this.createModelHero(e),this.removeElements([this.errorWrapperElm,this.loadingWrapperElm]),this.renderMap()}},{key:"createModelHero",value:function(e){var t=this.element.querySelector(".".concat("promo-reservation-form__model-hero"));try{var n=e.vehicleDetail,i={paint:n.paintOption.name,year:n.year,class:n.classId,model:n.modelId,bodyStyle:n.bodystyleId,options:{exterior:{PAINT:[n.paintOption],WHEELS:[n.wheelOption]}}};this.modelHero=new x(t,i)}catch(e){console.error(e)}}},{key:"renderMap",value:function(){this.googleMapContainer=this.successWrapperElm.querySelector(".".concat("promo-reservation-confirmation__map-container"));var e={maxWidth:l.sp.getState().small?180:230};this.googleMap=new Q.b6({config:{center:{lat:parseFloat(this.dealer.address[0].location.lat),lng:parseFloat(this.dealer.address[0].location.lng)}},element:this.googleMapContainer,infoWindowOptions:e,onMapCreatedCallback:this.onMapCreatedCallback})}},{key:"onMapCreatedCallback",value:function(){var e=this.dealer.address[0];this.googleMap.addMarkers([{id:(0,l.fV)(),icon:"/etc/designs/mb-nafta/images/icon-mb-dealer-location_black.png",location:this.googleMap.config.center,name:this.dealer.name,info:"\n                ".concat(e.line1,",\n                ").concat(""!==e.line2?"".concat(e.line2,","):"","\n                ").concat(e.city,", ").concat(e.state," ").concat(e.zip,"\n            ")}],!0)}},{key:"renderRequestError",value:function(){this.removeElements([this.titleHeroElm,this.ctaBannerElm,this.successWrapperElm,this.loadingWrapperElm])}},{key:"removeElements",value:function(e){return this.initialStateElm.classList.remove(ee),e.map((function(e){return e&&e.remove(),null}))}}]),e}(),ie=function(){function e(t){(0,o.Z)(this,e),this.element=t,this.modelHero=null,this.createModelHero()}return(0,r.Z)(e,[{key:"createModelHero",value:function(){try{var e=JSON.parse(window.mbNafta.pageData.promoReservation.jsonString),t=e.activeModelMeta,n=e.paintOptions,i=e.wheelOption,o={name:t.modelName,paint:n[0].name,year:t.year,class:t.model.vehicleClass.code,model:t.model.code,bodyStyle:t.bodystyle.code,options:{exterior:{PAINT:n,WHEELS:[i]}}};this.modelHero=new x(this.element,o)}catch(e){console.error(e)}}}]),e}(),oe=function(){function e(t){(0,o.Z)(this,e),this.element=t,this.modelColorSelector=null,this.onColorSwatchSelect=this.onColorSwatchSelect.bind(this),this.createColorSelector()}return(0,r.Z)(e,[{key:"createColorSelector",value:function(){try{var e=JSON.parse(window.mbNafta.pageData.promoReservation.jsonString).paintOptions.map((function(e){var t=e.id,n=e.name,i=e.media;return{label:n,value:t,swatchImageLarge:i[0].imgL,swatchImageSmall:i[0].imgS,alt:i[0].alt}})),t={element:this.element,defaultSelection:0,ariaControlRegionId:"promo-reservation-form-model-hero",selectionCallback:this.onColorSwatchSelect};this.modelColorSelector=new M(e,t)}catch(e){console.error(e)}}},{key:"onColorSwatchSelect",value:function(e,t){l.Jw.dispatchEvent(l.Jw.createCustomEvent(c.fD.UPDATE_EXTERIOR_COLOR,{detail:{paintId:t,paintName:e}}))}}]),e}(),re={PromoReservationForm:G,PromoReservationConfirmation:ne,PromoReservationModelHero:ie,PromoReservationModelColorSelector:oe,TextBlock:n(47984).Z}}}]);
//# sourceMappingURL=4ccd3a65161898bdc7f4.bundle.js.map
"use strict";(self.webpackChunk_mbusa_now_aem=self.webpackChunk_mbusa_now_aem||[]).push([[4190],{44190:function(t,e,i){i.d(e,{Z:function(){return _e}});var n=i(15671),s=i(43144),o=i(82963),a=i(11752),l=i(61120),r=i(60136),h=i(61156),c=i(48218),u=i(14569),d=i(75402),m=i(78478),p=i(82269),v=i(89462),y=i(20242),E=i(80458),g=i(70603),f="chapter-intro__border",b="playFullVideoBtn",C="teaserVideo",k="playPauseBtn",L="textBlock",P="accent",T="bodyCopy",S=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"setBindings",value:function(){this.onBorderTransitionEvent=this.onBorderTransitionEvent.bind(this),this.onAnimElemPlayinComplete=this.onAnimElemPlayinComplete.bind(this),this.onAnimElemPlayoutComplete=this.onAnimElemPlayoutComplete.bind(this),this.onMetadataLoaded=this.onMetadataLoaded.bind(this),this.onBatchAssetLoaderProgress=this.onBatchAssetLoaderProgress.bind(this),this.onCanPlay=this.onCanPlay.bind(this),this.onFullVideoClick=this.onFullVideoClick.bind(this),this.onBeforeVideoModalClose=this.onBeforeVideoModalClose.bind(this),this.onAfterVideoModalOpen=this.onAfterVideoModalOpen.bind(this),this.isVideoModalPresent=this.isVideoModalPresent.bind(this),(0,a.Z)((0,l.Z)(e.prototype),"setBindings",this).call(this)}},{key:"init",value:function(){this.assetsToLoad=[this.chapterData.data.html5video,this.chapterData.data.imgLarge.path],this.batchAssetLoaderMethod=h.XK.REQUEST_METHODS.GET,(0,a.Z)((0,l.Z)(e.prototype),"init",this).call(this)}},{key:"enterChapterLoadingState",value:function(){this.loadingMessage=(0,v.wi)(this.localization)({getNode:!0}),this.pctElm=this.loadingMessage.querySelector(".".concat("specialty-chapter__loading-pct")),(0,a.Z)((0,l.Z)(e.prototype),"enterChapterLoadingState",this).call(this)}},{key:"onBatchAssetLoaderProgress",value:function(){this.pctElm.textContent=parseInt(100*this.batchAssetLoader.currentBatchStatus.batchProgress,10)}},{key:"populateTemplate",value:function(){this.element=(0,y.r$)(this.chapterData.data,this.localization)({getNode:!0}),(0,a.Z)((0,l.Z)(e.prototype),"populateTemplate",this).call(this)}},{key:"cacheDOM",value:function(){this.specialtyChapterWrapperInnerElm=this.element.querySelector(".".concat("specialty-chapter__wrapper-inner")),this.teaserVideoElm=this.element.querySelector(".".concat("chapter-intro__teaser-video")),this.playPauseBtnElm=this.element.querySelector(".".concat("html5-video-player__button")),this.fullVideoButtonElm=this.element.querySelector(".".concat("chapter-intro__play-video")),this.textBlockElm=this.element.querySelector(".".concat("chapter-intro__copy")),this.bodyCopyElm=this.element.querySelector(".".concat("chapter-intro__description")),this.accentElm=this.element.querySelector(".".concat("chapter-intro__accent")),(0,a.Z)((0,l.Z)(e.prototype),"cacheDOM",this).call(this)}},{key:"registerAnimationElements",value:function(){m.Z.playinFinish=this.onAnimElemPlayinComplete,m.Z.playoutFinish=this.onAnimElemPlayoutComplete;var t=h.sp.getCurrentState(),i="small"===t?E.Z.playFullVideoBtnPlayinSm:E.Z.playFullVideoBtnPlayinLg,n="small"===t?E.Z.playFullVideoBtnPlayoutSm:E.Z.playFullVideoBtnPlayoutLg;this.fullVideoButtonElm&&(this.animationElements[b]=new m.Z(this.fullVideoButtonElm,{id:b,animationPlayin:i,animationPlayout:n})),this.teaserVideoElm&&(this.animationElements[C]=new m.Z(this.teaserVideoElm,{id:C,animationPlayin:E.Z.teaserVideoPlayin,animationPlayout:E.Z.teaserVideoPlayout})),this.playPauseBtnElm&&(this.animationElements[k]=new m.Z(this.playPauseBtnElm,{id:k,animationPlayin:E.Z.playPauseBtnPlayin,animationPlayout:E.Z.playPauseBtnPlayout})),this.animationElements[L]=new m.Z(this.textBlockElm,{id:L,animationPlayin:E.Z.textBlockPlayin,animationPlayout:E.Z.textBlockPlayout}),this.animationElements[T]=new m.Z(this.bodyCopyElm,{id:T,animationPlayin:E.Z.bodyCopyPlayin,animationPlayout:E.Z.bodyCopyPlayout}),this.animationElements[P]=new m.Z(this.accentElm,{id:P,animationPlayin:E.Z.accentPlayin,animationPlayout:E.Z.accentPlayout}),(0,a.Z)((0,l.Z)(e.prototype),"registerAnimationElements",this).call(this)}},{key:"render",value:function(){this.specialtyChapterBorderElm.classList.add(f),(0,a.Z)((0,l.Z)(e.prototype),"render",this).call(this)}},{key:"beginPlayin",value:function(){this.teaserVideoElm&&this.initHTML5VideoPlayer(),(0,a.Z)((0,l.Z)(e.prototype),"beginPlayin",this).call(this)}},{key:"beginPlayout",value:function(){var t,i;null===(t=this.youTubeModal)||void 0===t||t.closeYouTubeModal(),null===(i=this.html5VideoPlayer)||void 0===i||i.deactivate(),this.specialtyChapterBorderElm.classList.remove(f),(0,a.Z)((0,l.Z)(e.prototype),"beginPlayout",this).call(this)}},{key:"attachEvents",value:function(){var t,i,n;null===(t=this.teaserVideoElm)||void 0===t||t.addEventListener(c.FP.LOADED_METADATA,this.onMetadataLoaded),null===(i=this.teaserVideoElm)||void 0===i||i.addEventListener(c.FP.CAN_PLAY,this.onCanPlay),null===(n=this.fullVideoButtonElm)||void 0===n||n.addEventListener(c.FP.CLICK,this.onFullVideoClick),this.specialtyChapterBorderElm.addEventListener(c.FP.TRANSITION_START,this.onBorderTransitionEvent),this.specialtyChapterBorderElm.addEventListener(c.FP.TRANSITION_END,this.onBorderTransitionEvent),(0,a.Z)((0,l.Z)(e.prototype),"attachEvents",this).call(this)}},{key:"detachEvents",value:function(){var t,i,n;null===(t=this.teaserVideoElm)||void 0===t||t.removeEventListener(c.FP.LOADED_METADATA,this.onMetadataLoaded),null===(i=this.teaserVideoElm)||void 0===i||i.removeEventListener(c.FP.CAN_PLAY,this.onCanPlay),null===(n=this.fullVideoButtonElm)||void 0===n||n.removeEventListener(c.FP.CLICK,this.onFullVideoClick),this.specialtyChapterBorderElm.removeEventListener(c.FP.TRANSITION_START,this.onBorderTransitionEvent),this.specialtyChapterBorderElm.removeEventListener(c.FP.TRANSITION_END,this.onBorderTransitionEvent),(0,a.Z)((0,l.Z)(e.prototype),"detachEvents",this).call(this)}},{key:"onAnimElemPlayoutComplete",value:function(t){t===b&&this.animationElements[b].element.removeEventListener(c.FP.CLICK,this.onFullVideoClick),(0,a.Z)((0,l.Z)(e.prototype),"onAnimElemPlayoutComplete",this).call(this,t)}},{key:"onBorderTransitionEvent",value:function(t){"padding-top"===t.propertyName&&this.setBackgroundCover()}},{key:"onFullVideoClick",value:function(){this.initVideoModal(),this.initYouTubePlayer()}},{key:"onBeforeViolationModalOpen",value:function(){this.youTubeModal?this.youTubeModal.closeYouTubeModal():this.openSizeViolationModal()}},{key:"onAfterViolationModalOpen",value:function(){var t;null===(t=this.teaserVideoElm)||void 0===t||t.pause(),(0,a.Z)((0,l.Z)(e.prototype),"onAfterViolationModalOpen",this).call(this)}},{key:"onBeforeViolationModalClose",value:function(){var t;null===(t=this.teaserVideoElm)||void 0===t||t.play()}},{key:"onAfterVideoModalOpen",value:function(){var t;null===(t=this.teaserVideoElm)||void 0===t||t.pause(),this.youTubeModalContent.initialize()}},{key:"onBeforeVideoModalClose",value:function(){var t;this.youTubeModalContent.beforeYouTubeModalClose(),this.violationModalOpen?(this.videoModalClosedCallback=this.openSizeViolationModal,this.isVideoModalPresent()):(null===(t=this.teaserVideoElm)||void 0===t||t.play(),this.fullVideoButtonElm.focus())}},{key:"isVideoModalPresent",value:function(){document.querySelector(".".concat("modal--specialty-video"))?window.requestAnimationFrame(this.isVideoModalPresent):(this.videoModalClosedCallback(),this.videoModalClosedCallback=null)}},{key:"onMetadataLoaded",value:function(){this.setBackgroundCover()}},{key:"onCanPlay",value:function(){this.setBackgroundCover()}},{key:"onScreenResize",value:function(){this.setBackgroundCover()}},{key:"setBackgroundCover",value:function(){this.teaserVideoElm&&(0,g.s)({elm:this.teaserVideoElm},this.specialtyChapterWrapperInnerElm)}},{key:"initHTML5VideoPlayer",value:function(){this.html5VideoPlayer=new u.HTML5VideoPlayer(this.specialtyChapterWrapperInnerElm)}},{key:"initVideoModal",value:function(){this.youTubeModalContent=new d.u9({videoId:this.chapterData.data.youtube,videoTranscript:this.chapterData.data.youtubeTranscript})}},{key:"initYouTubePlayer",value:function(){this.youTubeModal=new d.vK(this.chapterData.data.youtube,this.youTubeModalContent.createYouTubeModalElement(),{afterModalOpen:this.onAfterVideoModalOpen,beforeModalClose:this.onBeforeVideoModalClose},"specialty-video")}}]),e}(p.Z),I=i(64589),A=i(82998),M="chapter-splash__border-background",D="chapter-splash__foreground-image",O="chapterSplashCopy",Z="chapterSplashVehicle",x=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"setBindings",value:function(){this.onAnimElemPlayinComplete=this.onAnimElemPlayinComplete.bind(this),this.onAnimElemPlayoutComplete=this.onAnimElemPlayoutComplete.bind(this),(0,a.Z)((0,l.Z)(e.prototype),"setBindings",this).call(this)}},{key:"init",value:function(){this.currentScreenState=h.sp.getState(),this.modelSpecificationsWidget=null,(0,a.Z)((0,l.Z)(e.prototype),"init",this).call(this)}},{key:"populateTemplate",value:function(){this.element=(0,y.bR)(this.chapterData.data,this.localization.disclaimer)({getNode:!0}),(0,a.Z)((0,l.Z)(e.prototype),"populateTemplate",this).call(this)}},{key:"cacheDOM",value:function(){this.specialtyChapterBorderElm=document.querySelector(".".concat("specialty-chapter__border")),this.specialtyChapterBorderBackgroundElm=document.querySelector(".".concat("specialty-chapter__border-background")),this.foregroundImage=this.element.querySelector(".".concat(D)),(0,a.Z)((0,l.Z)(e.prototype),"cacheDOM",this).call(this)}},{key:"render",value:function(){this.specialtyChapterBorderBackgroundElm.classList.add(M),this.specialtyChapterBorderBackgroundElm.style.backgroundImage="url(".concat(this.chapterData.data.backgroundImage.path,")"),(0,a.Z)((0,l.Z)(e.prototype),"render",this).call(this)}},{key:"beginPlayin",value:function(){this.cutout=new I.iU(this.element,this.chapterData.data.backgroundImage.path,this.foregroundImage.offsetTop,{dimensionsXLarge:{bottomRightPoint:0}}),this.chapterData.data&&this.chapterData.data.specifications&&this.chapterData.data.specifications.length&&(this.modelSpecificationsWidget=new I.Rm(this.element,this.chapterData.data)),(0,a.Z)((0,l.Z)(e.prototype),"beginPlayin",this).call(this)}},{key:"registerAnimationElements",value:function(){m.Z.playinFinish=this.onAnimElemPlayinComplete,m.Z.playoutFinish=this.onAnimElemPlayoutComplete,this.animationElements[O]=new m.Z(this.element.querySelector(".".concat("chapter-splash__copy")),{id:O,animationPlayin:A.Z.copyPlayin,animationPlayout:A.Z.copyPlayout}),this.animationElements[Z]=new m.Z(this.element.querySelector(".".concat(D)),{id:Z,animationPlayin:A.Z.vehiclePlayin,animationPlayout:A.Z.vehiclePlayout}),(0,a.Z)((0,l.Z)(e.prototype),"registerAnimationElements",this).call(this)}},{key:"beginPlayout",value:function(){this.specialtyChapterBorderBackgroundElm.classList.remove(M),this.cutout.beginPlayout(),(0,a.Z)((0,l.Z)(e.prototype),"beginPlayout",this).call(this)}},{key:"destroy",value:function(){this.specialtyChapterBorderBackgroundElm.style.backgroundImage="",this.modelSpecificationsWidget&&this.modelSpecificationsWidget.destroy(),(0,a.Z)((0,l.Z)(e.prototype),"destroy",this).call(this)}},{key:"onScreenResize",value:function(t){t&&((t.small||t.large)&&(this.cutout.bottomPoint=this.foregroundImage.offsetTop),this.currentScreenState=t)}}]),e}(p.Z),w=i(39520),B=function(){function t(e,i,s){(0,n.Z)(this,t),this.itemData=e,this.label=i,this.localization=s,this.init()}return(0,s.Z)(t,[{key:"init",value:function(){this.populateTemplate()}},{key:"populateTemplate",value:function(){}},{key:"render",value:function(){return this.element}}]),t}(),F=i(42982),_=i(5820),N="engine-carousel-item__sound-icon--active",R="engine-carousel-item__copy--active",H="engine-carousel-item__copy--animating",V="engine-carousel-item__svg--short-trip",K="aria-disabled",z="engine-sequence-000",W=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"init",value:function(){this.loadedImages=[],this.wasActivated=!1,this.indicatorCordinates=_.Z,this.setBindings(),this.populateTemplate(),this.cacheDOM(),this.initCanvas(),this.initAnimationInfo(),this.attachEvents(),this.loadFirstImage(),this.transformIndicator(),this.tabbables=new h.cs(this.element)}},{key:"setBindings",value:function(){this.onImageLoaded=this.onImageLoaded.bind(this),this.onClickHotspot=this.onClickHotspot.bind(this),this.playForward=this.playForward.bind(this),this.playReverse=this.playReverse.bind(this),this.onAudioClick=this.onAudioClick.bind(this),this.onAudioPlay=this.onAudioPlay.bind(this),this.onAudioPause=this.onAudioPause.bind(this),this.onAudioEnded=this.onAudioEnded.bind(this),this.onScreenResize=this.onScreenResize.bind(this),this.onDisclaimerClick=this.onDisclaimerClick.bind(this)}},{key:"populateTemplate",value:function(){this.element=(0,y.LT)(this.itemData,this.localization)({getNode:!0})}},{key:"cacheDOM",value:function(){this.innerWrapperElm=this.element.querySelector(".".concat("specialty-carousel__item-inner")),this.loadingElm=this.element.querySelector(".".concat("engine-carousel-item__loading")),this.pctElm=this.element.querySelector(".".concat("engine-carousel-item__loading-pct")),this.svgElm=this.element.querySelector(".".concat("engine-carousel-item__svg")),this.hotspotsElms=(0,F.Z)(this.element.querySelectorAll(".".concat("engine-carousel-item__hotspot"))),this.arcsElms=(0,F.Z)(this.element.querySelectorAll("path")),this.canvasElm=this.element.querySelector(".".concat("engine-carousel-item__canvas")),this.indicatorTextsElms=(0,F.Z)(this.element.querySelectorAll(".".concat("engine-carousel-item__controls-text"))),this.engineSoundBtnElm=this.element.querySelector(".".concat("engine-carousel-item__sound-button")),this.engineSoundIconElm=this.element.querySelector(".".concat("engine-carousel-item__sound-icon")),this.engineCopyElms=(0,F.Z)(this.element.querySelectorAll(".".concat("engine-carousel-item__copy"))),this.engineAudioElm=this.element.querySelector(".".concat("engine-carousel-item__audio")),this.disclaimerElms=(0,F.Z)(this.element.querySelectorAll(".".concat("specialty-page__disclaimer-marker")))}},{key:"initCanvas",value:function(){this.canvasElm.getContext&&(this.canvasCtx=this.canvasElm.getContext("2d"),this.canvasElm.addEventListener(c.FP.TOUCHSTART,(function(){})),this.canvasElm.addEventListener(c.FP.TOUCHMOVE,(function(){})))}},{key:"initAnimationInfo",value:function(){this.animInfo={currentPosition:0,animating:!1}}},{key:"attachEvents",value:function(){var t=this;h.sp.addResizeListener(this.onScreenResize),this.engineSoundBtnElm&&(this.engineSoundBtnElm.addEventListener(c.FP.CLICK,this.onAudioClick),this.engineAudioElm.addEventListener(c.FP.PLAY,this.onAudioPlay),this.engineAudioElm.addEventListener(c.FP.PAUSE,this.onAudioPause),this.engineAudioElm.addEventListener(c.FP.ENDED,this.onAudioEnded)),this.disclaimerElms.forEach((function(e){e.addEventListener(c.FP.CLICK,t.onDisclaimerClick)}))}},{key:"attachHotSpotEvent",value:function(){var t=this;this.hotspotsElms.forEach((function(e){e.addEventListener(c.FP.CLICK,t.onClickHotspot)}))}},{key:"detachEvents",value:function(){var t=this;h.sp.removeResizeListener(this.onScreenResize),this.hotspotsElms.forEach((function(e){e.removeEventListener(c.FP.CLICK,t.onClickHotspot)})),this.engineSoundBtnElm&&(this.engineSoundBtnElm.removeEventListener(c.FP.CLICK,this.onAudioClick),this.engineAudioElm.removeEventListener(c.FP.PLAY,this.onAudioPlay),this.engineAudioElm.removeEventListener(c.FP.PAUSE,this.onAudioPause),this.engineAudioElm.removeEventListener(c.FP.ENDED,this.onAudioEnded)),this.disclaimerElms.forEach((function(e){e.removeEventListener(c.FP.CLICK,t.onDisclaimerClick)}))}},{key:"loadFirstImage",value:function(){this.showLoadingMessage(!0),this.firstImage=new Image,this.firstImage.onload=this.onImageLoaded,this.firstImage.src="".concat(this.itemData.imageSequencePath,"/").concat(z,".jpg")}},{key:"activate",value:function(t){this.wasActivated||(this.wasActivated=!0,this.loadImages()),this.innerWrapperElm.setAttribute(K,"false"),this.tabbables.enableTabbables(),this.showCurrentCopyText(),t||this.hotspotsElms[0].focus()}},{key:"deactivate",value:function(){this.innerWrapperElm.setAttribute(K,"true"),this.engineSoundBtnElm&&this.engineAudioElm.pause(),this.engineCopyElms.forEach((function(t){t.classList.remove(R),t.setAttribute("aria-hidden","true")})),this.tabbables.enableTabbables(),this.tabbables.setTabbables(),this.tabbables.disableTabbables()}},{key:"transformIndicator",value:function(){var t=this.indicatorCordinates,e=t.small,i=t.xlarge,n=h.sp.gte(h.sp.SIZES.XLARGE)?i:e;this.arcsElms.forEach((function(t){t.classList.add("no-transition"),t.setAttribute("d",n.arc),window.requestAnimationFrame((function(){t.classList.remove("no-transition")}))})),this.hotspotsElms.forEach((function(t,e){(0,F.Z)(t.querySelectorAll("circle")).forEach((function(t){Object.keys(n.hotspots[e]).forEach((function(i){t.setAttribute(i,n.hotspots[e][i])})),t.setAttribute("r",-1!==t.getAttribute("class").indexOf("engine-carousel-item__hotspot-dot--inner")?n.dots.innerRadio:n.dots.outlineRadio)}))})),this.indicatorTextsElms.forEach((function(t,e){Object.keys(n.texts[e]).forEach((function(i){t.setAttribute(i,n.texts[e][i])}))}))}},{key:"onScreenResize",value:function(){this.transformIndicator()}},{key:"onAudioClick",value:function(){this.engineAudioElm.paused?(this.engineAudioElm.currentTime=0,this.engineAudioElm.volume=1,this.engineAudioElm.play()):this.engineAudioElm.pause()}},{key:"onAudioPlay",value:function(){this.engineSoundIconElm.classList.add(N)}},{key:"onAudioPause",value:function(){this.engineSoundIconElm.classList.remove(N)}},{key:"onAudioEnded",value:function(){this.engineAudioElm.pause()}},{key:"onClickHotspot",value:function(t){t.preventDefault();var e=parseInt(t.currentTarget.getAttribute("data-target-frame"),10),i=parseInt(t.currentTarget.getAttribute("data-end-point"),10);if(!this.animInfo.animating&&e!==this.animInfo.currentFrame){this.animInfo.targetFrame=e,this.animInfo.animating=!0;var n=this.animInfo.targetFrame>this.animInfo.currentFrame?this.playForward:this.playReverse;this.animInfo.canvasInterval=setInterval(n,33);var s=Math.abs(this.animInfo.currentPosition-i);if(this.svgElm.classList)this.svgElm.classList[1===s?"add":"remove"](V);else if("SVG"===this.svgElm.nodeName&&this.svgElm.getAttribute("class")){var o=this.svgElm.getAttribute("class")||"";1===s?o.split(" ").includes(V)||(o="".concat(o," ").concat(V)):o=o.replace(V,""),this.svgElm.setAttribute("class",o)}this.svgElm.setAttribute("active-hotspot",i),this.animInfo.currentPosition=i,this.showCurrentCopyText()}}},{key:"onDisclaimerClick",value:function(){h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.DOCKED_FOOTER.OPEN_FROM_DISCLAIMER,{detail:{currentTarget:event.currentTarget,legend:event.currentTarget.dataset.legend}}))}},{key:"showCurrentCopyText",value:function(){var t=this,e=this.animInfo.currentPosition;this.engineCopyElms.forEach((function(i,n){i.classList.contains(R)&&(i.classList.add(H),i.addEventListener(c.FP.TRANSITION_END,t.onTransitionEnd.bind(t,i))),i.classList[n===e?"add":"remove"](R),i.setAttribute("aria-hidden",n!==e)}))}},{key:"onTransitionEnd",value:function(t){t.removeEventListener(c.FP.TRANSITION_END,this.onTransitionEnd),t.classList.remove(H)}},{key:"playForward",value:function(){this.animInfo.currentFrame<this.animInfo.targetFrame-1?(this.animInfo.currentFrame+=1,this.canvasCtx.drawImage(this.loadedImages[this.animInfo.currentFrame],0,0)):this.onPlayComplete()}},{key:"playReverse",value:function(){this.animInfo.currentFrame>this.animInfo.targetFrame?(this.animInfo.currentFrame-=1,this.canvasCtx.drawImage(this.loadedImages[this.animInfo.currentFrame],0,0)):this.onPlayComplete()}},{key:"onPlayComplete",value:function(){clearInterval(this.animInfo.canvasInterval),this.animInfo.animating=!1}},{key:"showLoadingMessage",value:function(t){this.loadingElm.classList[t?"add":"remove"]("engine-carousel-item__loading--visible"),this.canvasElm.classList[t?"add":"remove"]("engine-carousel-item__canvas--loading")}},{key:"loadImages",value:function(){var t=this;this.showLoadingMessage(!0),this.itemData.assetPath.slice(1).forEach((function(e){var i=new Image;i.onload=t.onImageLoaded,i.src=e}))}},{key:"onImageLoaded",value:function(t){t.target.src.indexOf(z)>-1&&this.renderFirstImage(),this.loadedImages.push(t.target),this.updateImageLoadProgress(),this.loadedImages.length===this.itemData.assetPath.length&&(this.attachHotSpotEvent(),this.sortImages(),this.showLoadingMessage(!1))}},{key:"updateImageLoadProgress",value:function(){this.pctElm.textContent=Math.ceil(this.loadedImages.length/this.itemData.assetPath.length*100)||0}},{key:"renderFirstImage",value:function(){this.canvasElm.setAttribute("width",this.firstImage.width),this.canvasElm.setAttribute("height",this.firstImage.height),this.canvasCtx.drawImage(this.firstImage,0,0),this.animInfo.currentFrame=0,this.wasActivated||this.showLoadingMessage(!1)}},{key:"sortImages",value:function(){this.loadedImages.sort((function(t,e){var i=t.src.toLowerCase(),n=e.src.toLowerCase();return i<n?-1:i>n?1:0}))}}]),e}(B),j="tabindex",U=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"init",value:function(){this.populateTemplate(),this.cacheDOM()}},{key:"populateTemplate",value:function(){this.element=(0,y.ON)(this.itemData,this.localization)({getNode:!0})}},{key:"cacheDOM",value:function(){this.ctaElm=this.element.querySelector(".".concat("performance-carousel-item__cta"))}},{key:"activate",value:function(t){var e;t||this.element.focus(),null===(e=this.ctaElm)||void 0===e||e.removeAttribute(j)}},{key:"deactivate",value:function(){var t;null===(t=this.ctaElm)||void 0===t||t.setAttribute(j,"-1")}}]),e}(B),q="chapter-engine__border-background",G="chapter-engine--overview-visible",Y="chapter-engine--carousel-visible",J="textBlock",X="engineCarousel",Q="backToOverviewButton",$=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"setBindings",value:function(){this.onAnimElemPlayinComplete=this.onAnimElemPlayinComplete.bind(this),this.onAnimElemPlayoutComplete=this.onAnimElemPlayoutComplete.bind(this),this.onExploreEnginesCTAClick=this.onExploreEnginesCTAClick.bind(this),this.onBackButtonClick=this.onBackButtonClick.bind(this),(0,a.Z)((0,l.Z)(e.prototype),"setBindings",this).call(this)}},{key:"populateTemplate",value:function(){this.element=(0,y.lF)(this.chapterData.data,this.localization)({getNode:!0}),(0,a.Z)((0,l.Z)(e.prototype),"populateTemplate",this).call(this)}},{key:"cacheDOM",value:function(){this.engineCopyElm=this.element.querySelector(".".concat("chapter-engine__copy")),this.specialtyChapterBorderBackgroundElm=document.querySelector(".".concat("specialty-chapter__border-background")),this.exploreEnginesCTAElm=this.element.querySelector(".".concat("chapter-engine__explore-cta")),(0,a.Z)((0,l.Z)(e.prototype),"cacheDOM",this).call(this)}},{key:"attachEvents",value:function(){this.exploreEnginesCTAElm.addEventListener(c.FP.CLICK,this.onExploreEnginesCTAClick),(0,a.Z)((0,l.Z)(e.prototype),"attachEvents",this).call(this)}},{key:"registerAnimationElements",value:function(){m.Z.playinFinish=this.onAnimElemPlayinComplete,m.Z.playoutFinish=this.onAnimElemPlayoutComplete,this.animationElements[J]=new m.Z(this.engineCopyElm,{id:J,animationPlayin:w.Z.textBlockPlayin,animationPlayout:w.Z.textBlockPlayout}),(0,a.Z)((0,l.Z)(e.prototype),"registerAnimationElements",this).call(this)}},{key:"render",value:function(){this.specialtyChapterBorderBackgroundElm.classList.add(q),this.specialtyChapterBorderBackgroundElm.style.backgroundImage="url(".concat(this.chapterData.data.backgroundImage.path,")"),(0,a.Z)((0,l.Z)(e.prototype),"render",this).call(this)}},{key:"beginPlayin",value:function(){this.cutout=new I.iU(this.element,null,null,{dimensionsSmall:{bottomRightPoint:90,bottomRightPointMultiplier:1,bottomRightPointOffset:0},dimensionsLarge:{bottomRightPoint:245,bottomRightPointMultiplier:1,bottomRightPointOffset:0},dimensionsXLarge:{topRightPointMultiplier:.5,topRightPointOffset:365,bottomRightPointMultiplier:.36,bottomRightPointOffset:0,slashWidth:195}}),(0,a.Z)((0,l.Z)(e.prototype),"beginPlayin",this).call(this)}},{key:"onExploreEnginesCTAClick",value:function(){this.carousel||this.backButtonElm||(this.createBackButton(),this.createCarousel()),this.keepAnimations=!0,this.animationElements[J].isActive=!1,this.animationElements[J].beginPlayout(),this.specialtyChapterBorderBackgroundElm.classList.remove(q),this.cutout.hide(),this.animationElements[X].isActive=!0,this.animationElements[X].beginPlayin(),this.animationElements[Q].isActive=!0,this.animationElements[Q].beginPlayin(),this.backButtonElm.focus()}},{key:"onBackButtonClick",value:function(){this.keepAnimations=!0,this.animationElements[J].isActive=!0,this.animationElements[J].beginPlayin(),this.specialtyChapterBorderBackgroundElm.classList.add(q),this.cutout.show(),this.animationElements[X].isActive=!1,this.animationElements[X].beginPlayout(),this.animationElements[Q].isActive=!1,this.animationElements[Q].beginPlayout(),this.exploreEnginesCTAElm.focus()}},{key:"beginPlayout",value:function(){this.keepAnimations=!1,this.specialtyChapterBorderBackgroundElm.classList.remove(q),this.cutout.beginPlayout(),(0,a.Z)((0,l.Z)(e.prototype),"beginPlayout",this).call(this)}},{key:"destroy",value:function(){this.specialtyChapterBorderBackgroundElm.style.backgroundImage="",(0,a.Z)((0,l.Z)(e.prototype),"destroy",this).call(this)}},{key:"createBackButton",value:function(){var t=this.localization.enginesOverview;this.backButtonElm=h.jG.fromTemplate('<button class="chapter-engine__back-button">'.concat(t,"</button>")),this.backButtonElm.addEventListener(c.FP.CLICK,this.onBackButtonClick),h.jG.append(this.backButtonElm,this.element),this.animationElements[Q]=new m.Z(this.backButtonElm,{id:Q,animationPlayin:w.Z.backButtonPlayin,animationPlayout:w.Z.backButtonPlayout})}},{key:"createCarousel",value:function(){var t=this;this.carouselItems=this.chapterData.data.carouselItems.map((function(e){return new W(e,e.shortName,t.localization)})),this.carousel=new I.lr(this.carouselItems,this.localization.engine,this.element,{opacityOffset:1.6,yTranslate:"-54%",xFactor:.73},{previous:this.localization.previous,next:this.localization.next}),h.jG.append(this.carousel.render(),this.element),this.animationElements[X]=new m.Z(this.carousel.element,{id:X,animationPlayin:w.Z.carouselPlayin,animationPlayout:w.Z.carouselPlayout});var e=[].slice.call(this.carousel.element.querySelectorAll(".".concat("engine-carousel-item__controls-text")));requestAnimationFrame((function(){e.forEach((function(t){t.classList.remove("hide")}))}))}},{key:"onAnimElemPlayoutComplete",value:function(t){this.carousel&&t===J?(this.element.classList.remove(G),this.element.classList.add(Y),this.carousel.activate(),this.backButtonElm.removeAttribute("tabindex"),this.exploreEnginesCTAElm.setAttribute("tabindex","-1"),this.backButtonElm.focus()):this.carousel&&t===X&&(this.element.classList.add(G),this.element.classList.remove(Y),this.carousel.deactivate(),this.backButtonElm.setAttribute("tabindex","-1"),this.exploreEnginesCTAElm.removeAttribute("tabindex")),(0,a.Z)((0,l.Z)(e.prototype),"onAnimElemPlayoutComplete",this).call(this,t,this.keepAnimations)}},{key:"detachEvents",value:function(){this.carousel&&this.carousel.detachEvents(),this.carouselItems&&this.carouselItems.length>0&&this.carouselItems.forEach((function(t){t.detachEvents()})),(0,a.Z)((0,l.Z)(e.prototype),"detachEvents",this).call(this)}}]),e}(p.Z),tt=i(65716),et={EXPLORE_CTA:"performance-carousel-item__cta",HEADER:"header--docking-state",MAIN_NAVIGATION:"main-navigation--docking-state"},it="performanceCarousel",nt=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"setBindings",value:function(){this.onAnimElemPlayinComplete=this.onAnimElemPlayinComplete.bind(this),this.onAnimElemPlayoutComplete=this.onAnimElemPlayoutComplete.bind(this),this.onExploreClick=this.onExploreClick.bind(this),(0,a.Z)((0,l.Z)(e.prototype),"setBindings",this).call(this)}},{key:"populateTemplate",value:function(){this.element=(0,y.Dx)(this.chapterData.data,this.localization)({getNode:!0}),this.createCarousel(),(0,a.Z)((0,l.Z)(e.prototype),"populateTemplate",this).call(this)}},{key:"cacheDOM",value:function(){this.headerElm=document.querySelector(".".concat(et.HEADER,", .").concat(et.MAIN_NAVIGATION)),this.exploreBtnElms=(0,F.Z)(this.element.querySelectorAll(".".concat(et.EXPLORE_CTA))),(0,a.Z)((0,l.Z)(e.prototype),"cacheDOM",this).call(this)}},{key:"registerAnimationElements",value:function(){m.Z.playinFinish=this.onAnimElemPlayinComplete,m.Z.playoutFinish=this.onAnimElemPlayoutComplete,this.animationElements[it]=new m.Z(this.carousel.element,{id:it,animationPlayin:tt.Z.carouselPlayin,animationPlayout:tt.Z.carouselPlayout}),(0,a.Z)((0,l.Z)(e.prototype),"registerAnimationElements",this).call(this)}},{key:"attachEvents",value:function(){var t=this;this.exploreBtnElms.forEach((function(e){e.addEventListener(c.FP.CLICK,t.onExploreClick)})),(0,a.Z)((0,l.Z)(e.prototype),"attachEvents",this).call(this)}},{key:"detachEvents",value:function(){this.carousel.detachEvents(),(0,a.Z)((0,l.Z)(e.prototype),"detachEvents",this).call(this)}},{key:"onExploreClick",value:function(t){t.preventDefault(),t.stopPropagation(),this.initDetailModal(t.currentTarget),this.detailModal.open({callingContainer:t.currentTarget})}},{key:"createCarousel",value:function(){var t=this;this.carouselItems=this.chapterData.data.carouselItems.map((function(e){return new U(e,e.heading,t.localization)})),this.carousel=new I.lr(this.carouselItems,this.localization.performance,this.element,{opacityOffset:1.6,modClass:"performance",includeTitleNavigation:!0},{previous:this.localization.previous,next:this.localization.next}),h.jG.append(this.carousel.render(),this.element)}},{key:"onBeforeViolationModalClose",value:function(){this.headerElm&&(this.headerElm.classList.remove(et.LOCKED),h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.GLOBAL_NAV_ENABLE_TABBABLES)))}}]),e}(p.Z),st=i(52380),ot=i(83166),at="hotspot-info__click-shield--hide",lt="hotspot-info__panel",rt="show",ht="hide",ct="tabindex",ut="aria-hidden",dt={hotspotScales:{small:500,large:500,xlarge:400,xxlarge:400}},mt={x:300,y:-30,z:10},pt=function(){function t(e,i,s,o){(0,n.Z)(this,t),this.container=e,this.data=i,this.currentScreenState=h.sp.getCurrentState(),this.hotspots=[],this.activeHotspot=-1,this.appDamUrlPrefix=s,this.localization=o,this.setBindings(),this.cacheDOM(),this.tabbables=new h.cs(this.panel),this.setPanelFirstAndLastTabbable(),this.attachEvents()}return(0,s.Z)(t,[{key:"setBindings",value:function(){this.onTransitionEnd=this.onTransitionEnd.bind(this),this.onHotspotTransitionEnd=this.onHotspotTransitionEnd.bind(this),this.onHotspotClick=this.onHotspotClick.bind(this),this.onHotspotNavClick=this.onHotspotNavClick.bind(this),this.onPanelKeydown=this.onPanelKeydown.bind(this),this.onCloseClick=this.onCloseClick.bind(this),this.onScreenResize=this.onScreenResize.bind(this),this.setPanorama=this.setPanorama.bind(this)}},{key:"cacheDOM",value:function(){this.sectionInterior=this.container.querySelector(".".concat("chapter-design__section-interior")),this.interiorContainer=this.container.querySelector(".".concat("interior-section__container")),this.hotspotNavListElm=document.querySelector(".".concat("hotspot-nav__list")),this.panel=document.querySelector(".".concat(lt)),this.panelImageElm=this.panel.querySelector(".".concat("hotspot-info__image-placeholder")),this.panelHeadingElm=this.panel.querySelector(".".concat(lt," h3")),this.panelBodyElm=this.panel.querySelector(".".concat(lt," p")),this.closeButton=document.querySelector(".".concat("hotspot-info__close-panel")),this.navigationNavElm=document.querySelector(".".concat("waypoint-nav__container")),this.clickShield=document.querySelector(".".concat("hotspot-info__click-shield"))}},{key:"attachEvents",value:function(){var t,e;h.sp.addResizeListener(this.onScreenResize),this.closeButton.addEventListener(c.FP.CLICK,this.onCloseClick),this.clickShield.addEventListener(c.FP.CLICK,this.onCloseClick),null===(t=this.firstTabbable)||void 0===t||t.addEventListener(c.FP.KEYDOWN,this.onPanelKeydown),null===(e=this.lastTabbable)||void 0===e||e.addEventListener(c.FP.KEYDOWN,this.onPanelKeydown)}},{key:"detachEvents",value:function(){var t,e,i=this;h.sp.removeResizeListener(this.onScreenResize),this.closeButton.removeEventListener(c.FP.CLICK,this.onCloseClick),this.clickShield.removeEventListener(c.FP.CLICK,this.onCloseClick),null===(t=this.firstTabbable)||void 0===t||t.removeEventListener(c.FP.KEYDOWN,this.onPanelKeydown),null===(e=this.lastTabbable)||void 0===e||e.removeEventListener(c.FP.KEYDOWN,this.onPanelKeydown),this.hotspots.forEach((function(t){t.accessibleButton.removeEventListener(c.FP.CLICK,i.onHotspotNavClick)}))}},{key:"setPanorama",value:function(){this.panoImg=new Image,this.panoImg.src="".concat(this.appDamUrlPrefix,"/design/").concat(this.data.vehicleModel.code.toLowerCase(),"/interior/images/interior-pano-lg.jpg"),this.panorama.createPanorama(this.panoImg,"image"),this.addViewer(),this.resetHotspots()}},{key:"addViewer",value:function(){this.panorama.createViewer()}},{key:"activate",value:function(){this.panorama=new ot.Z(this.interiorContainer,{controlBar:!1,autoHideInfospot:!1,cameraFov:60,maxFov:80,minFov:50,minYAngle:.95,initialControlCenter:mt}),this.panorama.init(this.setPanorama)}},{key:"deactivate",value:function(){this.sectionInterior.addEventListener(c.FP.TRANSITION_END,this.onTransitionEnd)}},{key:"onTransitionEnd",value:function(){this.sectionInterior.removeEventListener(c.FP.TRANSITION_END,this.onTransitionEnd),this.destroyPanorama()}},{key:"destroyPanorama",value:function(){this.clearInfospots(),this.panel.classList.contains(rt)&&this.hideDetailPanel(),this.panorama&&this.panorama.destroy(),h.jG.empty(this.interiorContainer)}},{key:"populateHotspots",value:function(){var t=this;this.data.hotspots&&this.data.hotspots.forEach((function(e){var i=t.createInfospot(e),n=t.createHotspotButton(e,t.data.vehicleModel.name),s=n.querySelector(".".concat("hotspot-nav__button"));s.addEventListener(c.FP.CLICK,t.onHotspotNavClick);var o={infospot:i,accessibleButtonParent:n,accessibleButton:s,data:e,id:i.uuid};t.hotspots.push(o)}))}},{key:"createInfospot",value:function(t){var e=this.panorama.createInfospot(dt.hotspotScales[this.currentScreenState],"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFoAAABaCAYAAAA4qEECAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQwIDc5LjE2MDQ1MSwgMjAxNy8wNS8wNi0wMTowODoyMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkMwMjgwNjJCRTExNTExRTg4MEU3ODIyRThBQUI1MjJBIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkMwMjgwNjJDRTExNTExRTg4MEU3ODIyRThBQUI1MjJBIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QzAyODA2MjlFMTE1MTFFODgwRTc4MjJFOEFBQjUyMkEiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QzAyODA2MkFFMTE1MTFFODgwRTc4MjJFOEFBQjUyMkEiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7bpCsjAAAIuUlEQVR42uxda2wUVRS+pYXSHxRBAsqf/gEiplaSVnlY/tgfDS1iiOIj4ZE0hAIJETHaAkYwQWkx8ipRecTI44cBDIkWtMHiD8pTSNQoYiUkJEaRIEj5UR6W+h17Bs4OO3d39s7Mzo5zkq+7OzM7c843Z8495/beu3m9vb0qFv+lX0xBTHRMdCwx0THRMdGxxERHSQpMT3A6L88LPR4BaoHJjAcNznUZ6AAOA/uBs34SWJ5mHZJnWrAYEF0C1AEzgLF2vQxUsht0BtgLfAxc+D8RXQ0sAmo0hHpJtNx+AGgB2oImOsgYTQQfB77iMGEnsxs4CCw1vM5SPk93kptXy9c/zvoEJkF49GhgAzAlyb5bwD5gD3tbt4e2FfFTQ6FpOjAgyTF0zcXAr7kcOgrYu95MYuRFfoS3AZcCcKjhwFwOWQ8ludmrgNXAP7lG9ChgFzDetv1PoAnY7LH3uvHyeqARGGHbdwKYCZzLlRg9FThlI7kHWAeMAdZniWSrHVjPeqxjvSwZz3pPzYWCpQH4HBgstv0IVABLgK6Q1A9drE8F62fJYNa/IayNIf15H3jVtnsT8Dpww+XjOAgvTwJl7H1jmIQHON5TXP0buMYN2S/AD8BJ6HPdpQkDgTUcv6WQx7+mSRcDj9FE8kfAPLH5JsfC7S7IpQbrBc4SJmVYtVJjdpSzmN3QzU1DO4fbjkKxjexaqCM7SKLX2jy5i9OqI2kSPAEvb3Bs7O/h03obaCVvhY7H0/zOU5zyFds8e0lWiYYBDZxFyH6GKn6MUxFcwd+tCiAmt1OqCX2/TePYMj5+mNhGWUpzVoiG0lO54cgTnjw5FclQbAhe3uVQE2RlegfYAiyD7lfTIPuw8Gz67rP8hARHNBQdxanQYBGTq1KFCyhFx+wARmYx4/gdmA0b2tMII+0iZl/jLOVcIHk0FCzgYkSmcPVpkNzAnTnZJFnx9dtYH50cYbtk6rcrw0Y6o0d3qa0Y2aTLLmBQPrCV43F+SPJo0qMJem0EdBxs564CWdRk1OnlKnTAm0dzgm/1XfzEj9MNJ5LxshN4WYVXKJTVwbYeTZ5NjWip6BsptTqi/AodGwTJPdw3oCtGWkJOMslsm9faheybJcr1AVzG+xM6cMep/1Z2ddJj950mZFBuvEDlhixgfZ2E7NwoPlOdUO1L6OCkf7zohRsD5bqS9d5xdtEWopicjpDHVmuyEUr1OtW9Xj/q7Zvgaehgb5YNIDUkXZo8eWeOkWw1kDtYf6eOqCZbw1jtdeiQHS4XuU/ASagYeVjlplDq945m/2a2PxkvZkTDm0s4Jt1t4HDXux28+Qlb51IuSj3bkUy6bQ1nDfPjiUfXiTKbUpttmmNXq9wflNOP7XCSbcyDYl7qvCJ6hni/D3f7koM3T/C7g4gaXgs+SxXsmeiwj+zfJz4/b0w0DKIRRHJwyx7N4Y0qWqIr0SUPjzJPRh5da4tPBxy8eaTt2ChILduVTOxDI2pNiZ4s3nc4NYKQF5UH4/hCJgVsl1Oj2OHAU0ZEV4r3hzTHPaOiKdM0+w458GRWGWqExkpc4c4XX0U2guXBzCajfo6huG63pqvB274OjUwMguQsyUC2z5Oc0VTKVbSlPCxEj4040WPDQnRJxIkuCQvRQyNO9BCvckVTGeRVJuHX9wwzlEFh8ej+EffoAWEh+nbEib4VltBx3eTL5e7+Cx90wWJsn5cefTXiHn01LERfiDjRF8JC9JmIE/1zWIg+HXGiT4eF6GOqbzRpFOUm2+cv0Wjl/wJ6GY0Ox3R7pUwI5Zimi5T4sLi5bOrRh8X7pzXHfRFRonV2ST46TImWJ6jEnStyOO5TlcGs05AL2bPbYR/xUOngkBkR3Wo7eY1D+KBR9PsjRvR+2PWbw74a5uPusUZEo/o6a0tvZmgOXxMxonX2SB7OME/GWYccwzAdd3m4g1fT/L5DflpOZbcFn6Wd7UkmZP908XmvV+kdrdxiWUY9WXM1x9K0gzs57smk/zLN/rnqXo9eL/NjTjS8h0rQL8WmRU6NIrafxMvWHCd6C9vh1AjKEaQHmB/PChY52p3Wu6jXHEve8EeOkkx6L9fsr1eJ6320eFoZ4q7R6P0TMlnHXS928Goa40HzQnpyjGTSdw7rn0yKVeL4QuKjzVOiWVaI9zS9YKWmovw6RZwLoyyH3gc1+1eqxMVUVrg5udvpbzS4b4rwAJr6ppsw9IHKjQlDH8K2hZr941TfTGFrugjxUGtlQl57NMkr6t6/dqw5hLpRSou4agyz7FL6KRIDVeKcHLJ/sduLuCIad48mMa4Sm0p1iT1PkpyZbgqUBWnhuNyTonApFZ/Jfterirke5MhzwakPRM7SokVFdqS4SY2sZBhma/VwTG5OcRzZ9YmtAayU/TrZWN2AerOOpiA7DKsbUAo3K/SrG/DJz3FIsK5SyEVNWYobRIo/pvqmkQVdQd7h65amQXIZN3iFogJ0vVSbMdFMdqtKnOlfzB6QiuwrwHy8pclF3wREMl1nIl1XkydLkttV4nI/ZGeriQJ+rak0JVUYETfM7zWV3oOO6f4HaBI/meFaU4mJplEtlC/PF5spZs9L1UDaFKZesZeA55T5KmGfUVrpcpUwqma3qBCvEvbfeVTyde9a2FszXffucXX/uneFfCOtde86Gd+riK97Jz/S3LzVKnHJYlpIZZaugsyijONiRObJvRyTm9N0Cn8bQwch5aaxp8mihlLBtbbYl00pZn1O2Ui+xvo3e31BP+Ztt3K+KXv78jmsdHL5WpQlgov4+p2sT76tGKkwzS6CJFpxvkkV1FsqcdjrCI5951Vf797wgAgeztc7z9eXvXC3WM9Kkzw56BidTOIV0VWwP6ZAq7W8re5fvNsSa9ov/YO3yUClRu4OqNSEKAoT1J9s/KMK8a9WJN+etV+tiH+H5X9AtBT5y0L0yA8zOFc0f1koluymd7HERMdEx0THEhMdEx1LovwrwABH0QDd0wRqPgAAAABJRU5ErkJggg==");return e.position.set(parseInt(t.xaxis,10),parseInt(t.yaxis,10),parseInt(t.zaxis,10)),e.setCursorHoverStyle("pointer"),e.addEventListener(c.FP.CLICK,this.onHotspotClick),e.show(500),e}},{key:"removeInfospot",value:function(t){var e=t.infospot;this.panorama.removeInfospot(e),e.removeEventListener(c.FP.CLICK,this.onHotspotClick)}},{key:"createHotspotButton",value:function(t,e){var i=t.heading,n=(0,y.N)(i,e,this.localization)({getNode:!0});return h.jG.append(n,this.hotspotNavListElm),n}},{key:"updatePanorama",value:function(){this.panorama.animateViewer(),this.panorama.removePanorama(),this.panorama.createPanorama(),this.panorama.addHotspots(this.hotspots),this.panorama.addViewer(),this.panel.getAttribute(ut)||window.cancelAnimationFrame(this.panorama.getViewerAnimationId())}},{key:"resetHotspots",value:function(){this.clearInfospots(),this.populateHotspots(),this.updatePanorama()}},{key:"clearInfospots",value:function(){for(;this.hotspots.length>0;){var t=this.hotspots.shift();t.accessibleButton.removeEventListener(c.FP.CLICK,this.onHotspotNavClick),this.removeInfospot(t)}h.jG.empty(this.hotspotNavListElm)}},{key:"setPanelFirstAndLastTabbable",value:function(){var t=this.tabbables.allTabbables;this.firstTabbable=t[0],this.lastTabbable=t[t.length-1]}},{key:"onPanelKeydown",value:function(t){t.keyCode===c.sd.TAB&&(t.preventDefault(),t.shiftKey||t.target!==this.lastTabbable?t.shiftKey&&t.target===this.firstTabbable&&this.lastTabbable.focus():this.firstTabbable.focus())}},{key:"showDetailPanel",value:function(t){var e=this;h.sp.getState().small||this.navigationNavElm.classList.add(ht),this.hotspots.forEach((function(t){t.accessibleButton.setAttribute(ct,"-1")})),"small"===this.currentScreenState&&t.imgSmall.path?this.panelImageElm.style.backgroundImage="url(".concat(t.imgSmall.path,")"):this.panelImageElm.style.backgroundImage="url(".concat(t.imgLarge.path,")"),this.panelHeadingElm.textContent=t.heading,this.panelBodyElm.textContent=t.description,this.panel.classList.add(rt),this.panel.addEventListener(c.FP.TRANSITION_END,this.onHotspotTransitionEnd),this.panel.setAttribute(ut,"false"),this.clickShield.classList.remove(at),this.closeButton.setAttribute(ct,"0"),this.infospotFocusTimeout=setTimeout((function(){window.cancelAnimationFrame(e.panorama.getViewerAnimationId())}),1e3)}},{key:"onHotspotTransitionEnd",value:function(){this.panel.removeEventListener(c.FP.TRANSITION_END,this.onHotspotTransitionEnd),this.closeButton.focus()}},{key:"hideDetailPanel",value:function(){this.panel.removeEventListener(c.FP.TRANSITION_END,this.onHotspotTransitionEnd),h.sp.getState().small||this.navigationNavElm.classList.remove(ht),this.panel.classList.remove(rt),this.panel.setAttribute(ut,"true"),this.clickShield.classList.add(at),this.closeButton.setAttribute(ct,"-1"),this.panorama.animateViewer()}},{key:"onHotspotClick",value:function(t){var e=this;this.hotspots.some((function(i,n){return t.target===e.hotspots[n].infospot&&(e.hotspots[n].accessibleButton.click(),!0)}))}},{key:"onHotspotNavClick",value:function(t){var e=this;this.hotspots.some((function(i,n){return t.currentTarget.parentNode===i.accessibleButtonParent&&(e.setActiveHotspot(i.infospot,i.data,n),!0)}))}},{key:"setActiveHotspot",value:function(t,e,i){this.activeHotspot=i,t.focus(),this.showDetailPanel(e),h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.SPECIALTY_PAGE_LOCK_SCROLL))}},{key:"onCloseClick",value:function(){var t=this;this.hideDetailPanel(),this.hotspots.forEach((function(e,i){var n=e.accessibleButton;n.removeAttribute(ct),i===t.activeHotspot&&(t.hotspotFocusTimeout=setTimeout((function(){n.focus()}),1e3))})),this.activeHotspot=-1,h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.SPECIALTY_PAGE_UNLOCK_SCROLL))}},{key:"onScreenResize",value:function(t){var e=this;t[this.currentScreenState]||(Object.keys(t).forEach((function(i){!0===t[i]&&(e.currentScreenState=i)})),this.resetHotspots())}},{key:"destroy",value:function(){this.destroyPanorama(),this.detachEvents()}}]),t}(),vt=i(18282),yt="exterior-section__scrubber--hidden",Et="exterior-section__scrubber--suppressed",gt="exterior-section__scrubber-handle--active",ft=function(){function t(e,i,s,o,a){(0,n.Z)(this,t),this.container=e,this.data=i,this.imagePaths=s,this.imageObjs=[],this.mouseOffset=0,this.mouseDifference=0,this.handleTouchEvents=!1,this.appDamUrlPrefix=o,this.localization=a,this.setBindings(),this.cacheDOM(),this.initCanvas(),this.attachEvents(),this.createImages()}return(0,s.Z)(t,[{key:"setBindings",value:function(){this.onScreenResize=this.onScreenResize.bind(this),this.onImageLoaded=this.onImageLoaded.bind(this),this.onMousedown=this.onMousedown.bind(this),this.onMouseup=this.onMouseup.bind(this),this.onMouseleave=this.onMouseleave.bind(this),this.onMousemove=this.onMousemove.bind(this),this.onTouchstart=this.onTouchstart.bind(this),this.onTouchend=this.onTouchend.bind(this),this.onTouchmove=this.onTouchmove.bind(this),this.onHandleMousedown=this.onHandleMousedown.bind(this),this.onHandleMouseup=this.onHandleMouseup.bind(this),this.onHandleMousemove=this.onHandleMousemove.bind(this),this.onHandleTouchstart=this.onHandleTouchstart.bind(this),this.onHandleTouchmove=this.onHandleTouchmove.bind(this),this.onHandleTouchend=this.onHandleTouchend.bind(this),this.onKeydownHandler=this.onKeydownHandler.bind(this),this.onTrackClick=this.onTrackClick.bind(this)}},{key:"cacheDOM",value:function(){this.bodyElm=document.querySelector("body"),this.exteriorContainerElm=this.container.querySelector(".".concat("exterior-section__container")),this.exteriorCanvasElm=this.container.querySelector(".".concat("exterior-section__canvas")),this.exteriorExploreElm=this.container.querySelector(".".concat("chapter-design__explore")),this.exteriorBuildElm=this.container.querySelector(".".concat("exterior-section__build")),this.exteriorScrubberElm=this.container.querySelector(".".concat("exterior-section__scrubber")),this.exteriorScrubberTrackElm=this.container.querySelector(".".concat("exterior-section__scrubber-track")),this.exteriorScrubberHandleElm=this.container.querySelector(".".concat("exterior-section__scrubber-handle")),this.exteriorBuildButtonElm=this.container.querySelector(".".concat("specialty-apps-amg__button"))}},{key:"initCanvas",value:function(){this.exteriorCanvasElm.getContext&&(this.canvasCtx=this.exteriorCanvasElm.getContext("2d")),this.createScrubberGradient()}},{key:"createScrubberGradient",value:function(){var t=this,e=this.data.vehicleModel.code.toLowerCase();return this.getHexJson("".concat(this.appDamUrlPrefix,"/design/").concat(e,"/exterior/json/").concat(e,".json")).then((function(e){var i=e.hexes.split(",");i.push(i[0]),t.colorsCount=i.length,t.gradientPercentage=(100/(t.colorsCount-1)).toFixed(2);var n=i.map((function(e,i){var n=Math.round(t.gradientPercentage*i);return"".concat(e," ").concat(n,"%")})).join(", ");t.addScrubberGradient(n)})).catch((function(e){console.error("color bar json file did not load; err = ",e),t.suppressScrubberGradient()}))}},{key:"getHexJson",value:function(t){return fetch(t,{headers:{"Content-Type":"application/json","Referrer-Policy":"origin",Referer:window.location.href},method:"GET"}).then((function(t){return t.json()})).catch((function(){return{hexes:vt.Z}}))}},{key:"addScrubberGradient",value:function(t){this.exteriorScrubberTrackElm.style.backgroundImage="linear-gradient(to left, ".concat(t,")"),this.exteriorScrubberElm.classList.remove(Et)}},{key:"suppressScrubberGradient",value:function(){this.exteriorScrubberElm.classList.add(Et)}},{key:"createImages",value:function(){var t=this;this.imagePaths.forEach((function(e){var i=new Image;i.onload=t.onImageLoaded,i.src=e}))}},{key:"onImageLoaded",value:function(t){this.imageObjs.push(t.target),this.imageObjs.length===this.imagePaths.length&&(this.imageObjs.sort((function(t,e){var i=t.src.toLowerCase(),n=e.src.toLowerCase();return i<n?-1:i>n?1:0})),this.setBackgroundCover(),this.playin(),this.setInitialPct())}},{key:"setInitialPct",value:function(){this.mouseOffset=this.exteriorContainerElm.offsetWidth/2,this.swapImage(.5),this.updateScrubberHandlePosition(.5)}},{key:"playin",value:function(){this.exteriorCanvasElm.classList.remove("exterior-section__canvas--hidden"),this.exteriorScrubberElm.classList.contains(Et)||this.exteriorScrubberElm.classList.remove(yt),this.exteriorExploreElm.classList.remove("chapter-design__explore--hidden"),this.exteriorBuildElm&&this.exteriorBuildElm.classList.remove("exterior-section__build--hidden")}},{key:"calculatePercentage",value:function(t){var e=(this.mouseOffset/this.exteriorContainerElm.offsetWidth%1-1)%1*-1;this.swapImage(e),this.updateScrubberHandlePosition(e);var i=Math.round(1e3*(1-e))/10;this.exteriorScrubberHandleElm.ariaValueNow=i;var n=t?this.localization.right:this.localization.left,s=Math.round(360*(1-e)).toString(),o=(0,h.NR)(this.localization.rotatingDirections,[n,s]);this.exteriorScrubberHandleElm.ariaValueText=o}},{key:"swapImage",value:function(t){var e=Math.floor(t*this.imageObjs.length);this.canvasCtx.drawImage(this.imageObjs[e],0,0)}},{key:"updateScrubberHandlePosition",value:function(t){this.exteriorScrubberElm.classList.contains(yt)||(this.exteriorScrubberHandleElm.style.left="".concat(-1*(100*t-100),"%"))}},{key:"attachEvents",value:function(){h.sp.addResizeListener(this.onScreenResize),this.exteriorCanvasElm.addEventListener(c.FP.MOUSEDOWN,this.onMousedown),this.exteriorCanvasElm.addEventListener(c.FP.MOUSEUP,this.onMouseup),this.exteriorCanvasElm.addEventListener(c.FP.TOUCHSTART,this.onTouchstart),this.exteriorCanvasElm.addEventListener(c.FP.TOUCHEND,this.onTouchend),this.exteriorCanvasElm.addEventListener(c.FP.TOUCHMOVE,this.onTouchmove),this.exteriorScrubberTrackElm.addEventListener(c.FP.CLICK,this.onTrackClick),this.exteriorScrubberHandleElm.addEventListener(c.FP.MOUSEDOWN,this.onHandleMousedown),this.exteriorScrubberHandleElm.addEventListener(c.FP.TOUCHSTART,this.onHandleTouchstart),this.exteriorScrubberHandleElm.addEventListener(c.FP.KEYDOWN,this.onKeydownHandler)}},{key:"detachEvents",value:function(){h.sp.removeResizeListener(this.onScreenResize),this.exteriorCanvasElm.removeEventListener(c.FP.MOUSEDOWN,this.onMousedown),this.exteriorCanvasElm.removeEventListener(c.FP.MOUSEUP,this.onMouseup),this.exteriorCanvasElm.removeEventListener(c.FP.MOUSELEAVE,this.onMouseleave),this.exteriorCanvasElm.removeEventListener(c.FP.TOUCHSTART,this.onTouchstart),this.exteriorCanvasElm.removeEventListener(c.FP.TOUCHEND,this.onTouchend),this.exteriorCanvasElm.removeEventListener(c.FP.TOUCHMOVE,this.onTouchmove),this.exteriorScrubberHandleElm.removeEventListener(c.FP.MOUSEDOWN,this.onHandleMousedown),this.exteriorScrubberHandleElm.removeEventListener(c.FP.TOUCHSTART,this.onHandleTouchstart)}},{key:"deactivate",value:function(){this.setTabIndexForButtons(-1)}},{key:"activate",value:function(){this.setTabIndexForButtons(0)}},{key:"setTabIndexForButtons",value:function(t){this.exteriorScrubberHandleElm.setAttribute("tabIndex",t),this.exteriorBuildButtonElm.setAttribute("tabIndex",t)}},{key:"onMousedown",value:function(t){this.mouseDifference=this.mouseOffset-t.clientX,this.exteriorCanvasElm.addEventListener(c.FP.MOUSEMOVE,this.onMousemove),this.exteriorCanvasElm.addEventListener(c.FP.MOUSELEAVE,this.onMouseleave)}},{key:"onMouseup",value:function(){this.exteriorCanvasElm.removeEventListener(c.FP.MOUSEMOVE,this.onMousemove),this.exteriorCanvasElm.removeEventListener(c.FP.MOUSELEAVE,this.onMouseleave)}},{key:"onMouseleave",value:function(){this.exteriorCanvasElm.removeEventListener(c.FP.MOUSEMOVE,this.onMousemove),this.exteriorCanvasElm.removeEventListener(c.FP.MOUSELEAVE,this.onMouseleave)}},{key:"onMousemove",value:function(t){var e=this.mouseOffset<=t.clientX;this.mouseOffset=t.clientX+this.mouseDifference,this.calculatePercentage(e)}},{key:"onTouchstart",value:function(t){t.preventDefault(),this.mouseDifference=this.mouseOffset-t.touches[0].pageX,this.exteriorCanvasElm.addEventListener(c.FP.TOUCHMOVE,this.onTouchmove)}},{key:"onTouchend",value:function(){this.exteriorCanvasElm.removeEventListener(c.FP.TOUCHMOVE,this.onTouchmove)}},{key:"onTouchmove",value:function(t){var e=this.mouseOffset<=t.touches[0].pageX+this.mouseDifference;this.mouseOffset=t.touches[0].pageX+this.mouseDifference,this.calculatePercentage(e)}},{key:"onHandleMousedown",value:function(t){this.handleTouchEvents||(this.exteriorScrubberHandleElm.classList.add(gt),this.bodyElm.addEventListener(c.FP.MOUSEMOVE,this.onHandleMousemove),this.bodyElm.addEventListener(c.FP.MOUSEUP,this.onHandleMouseup),this.mouseDifference=this.mouseOffset-t.clientX)}},{key:"onHandleMouseup",value:function(t){this.exteriorScrubberHandleElm.classList.remove(gt),this.bodyElm.removeEventListener(c.FP.MOUSEMOVE,this.onHandleMousemove),this.bodyElm.removeEventListener(c.FP.MOUSEUP,this.onHandleMouseup),this.mouseOffset=t.clientX}},{key:"onHandleMousemove",value:function(t){var e=this.mouseOffset<=t.clientX;this.mouseOffset=t.clientX+this.mouseDifference,this.calculatePercentage(e)}},{key:"onHandleTouchstart",value:function(t){t.preventDefault(),this.handleTouchEvents=!0,this.exteriorScrubberHandleElm.classList.add(gt),this.bodyElm.addEventListener(c.FP.TOUCHMOVE,this.onHandleTouchmove),this.bodyElm.addEventListener(c.FP.TOUCHEND,this.onHandleTouchend),this.mouseDifference=this.mouseOffset-t.touches[0].pageX}},{key:"onHandleTouchmove",value:function(t){var e=this.mouseOffset<=t.touches[0].pageX;this.mouseOffset=t.touches[0].pageX,this.calculatePercentage(e)}},{key:"onHandleTouchend",value:function(){this.exteriorScrubberHandleElm.classList.remove(gt),this.bodyElm.removeEventListener(c.FP.TOUCHMOVE,this.onHandleTouchmove),this.bodyElm.removeEventListener(c.FP.TOUCHEND,this.onHandleTouchend)}},{key:"onKeydownHandler",value:function(t){if(39===t.keyCode&&(t.preventDefault(),this.exteriorScrubberHandleElm.classList.add(gt),this.mouseOffset=this.mouseOffset+10,this.calculatePercentage(!0)),37===t.keyCode&&(t.preventDefault(),this.exteriorScrubberHandleElm.classList.add(gt),this.mouseOffset=this.mouseOffset-10,this.calculatePercentage(!1)),9===t.keyCode){var e=(this.mouseOffset/this.exteriorContainerElm.offsetWidth%1-1)%1*-1,i=Math.round(360*(1-e)).toString(),n=(0,h.NR)(this.localization.viewDegrees,[i]);this.exteriorScrubberHandleElm.ariaValueText=n,this.exteriorScrubberHandleElm.classList.remove(gt)}}},{key:"onTrackClick",value:function(t){var e=this.mouseOffset<=t.clientX;this.mouseOffset=t.clientX,this.calculatePercentage(e)}},{key:"onScreenResize",value:function(){this.setBackgroundCover()}},{key:"setBackgroundCover",value:function(){this.exteriorCanvasElm.offsetWidth/this.exteriorCanvasElm.offsetHeight>this.exteriorContainerElm.offsetWidth/this.exteriorContainerElm.offsetHeight?(this.exteriorCanvasElm.style.width="auto",this.exteriorCanvasElm.style.height="100%"):(this.exteriorCanvasElm.style.width="100%",this.exteriorCanvasElm.style.height="auto")}},{key:"destroy",value:function(){this.detachEvents()}}]),t}(),bt="chapter-design__section-toggle--inactive",Ct="chapter-design__section",kt="chapter-design__section--active",Lt="chapter-design__section-exterior",Pt="chapter-design__model-loading-message--active",Tt="specialty-chapter__loading-pct",St="on-loading",It="switch-model",At="switch-view",Mt="tabindex",Dt="chapterDesignHeading",Ot="chapterDesignModelsCta",Zt="chapterDesignSectionToggle",xt="chapterDesignSectionWrapper",wt="chapterModelsNav",Bt=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"setBindings",value:function(){this.onAnimElemPlayinComplete=this.onAnimElemPlayinComplete.bind(this),this.onAnimElemPlayoutComplete=this.onAnimElemPlayoutComplete.bind(this),this.onToggleButtonClick=this.onToggleButtonClick.bind(this),this.onModelNavigationClick=this.onModelNavigationClick.bind(this),this.onBatchModelAssetLoaderProgress=this.onBatchModelAssetLoaderProgress.bind(this),this.onBatchModelAssetLoaderComplete=this.onBatchModelAssetLoaderComplete.bind(this),this.onModelLoadingPlayinTransitionEnd=this.onModelLoadingPlayinTransitionEnd.bind(this),this.onModelLoadingPlayoutTransitionEnd=this.onModelLoadingPlayoutTransitionEnd.bind(this),this.onInteriorMutation=this.onInteriorMutation.bind(this),(0,a.Z)((0,l.Z)(e.prototype),"setBindings",this).call(this)}},{key:"validateData",value:function(){var t=this.chapterData.data;return t.amgInteriorTiles=t.amgInteriorTiles.filter((function(t){return t.imageCount>0&&t.vehicleModel})),t.amgInteriorTiles.length>0}},{key:"init",value:function(){this.isExterior=!0,this.modelIndex=0,this.modelIndexInterior=0,this.modelIndexExterior=0,this.currentScreenState=h.sp.getState(),this.assetsToLoad=[].concat((0,F.Z)(this.collectExteriorImages()),[this.getInteriorImage()]),this.batchAssetLoaderMethod=h.XK.REQUEST_METHODS.GET,this.screenSize=h.sp.getCurrentState(),(0,a.Z)((0,l.Z)(e.prototype),"init",this).call(this)}},{key:"collectExteriorImages",value:function(){this.exteriorImages=[];for(var t=0,e=this.chapterData.data.amgInteriorTiles[this.modelIndex].imageCount;t<e;t+=1){var i=t<100?"0".concat(t<10?"0".concat(t):t):t;this.exteriorImages.push("".concat(this.appDamUrlPrefix,"/design/").concat(this.chapterData.data.amgInteriorTiles[this.modelIndex].vehicleModel.code.toLowerCase(),"/exterior/images/lg/exterior-").concat(i,".jpg"))}return this.exteriorImages}},{key:"getInteriorImage",value:function(){return"".concat(this.appDamUrlPrefix,"/design/").concat(this.chapterData.data.amgInteriorTiles[this.modelIndex].vehicleModel.code.toLowerCase(),"/interior/images/interior-pano-lg.jpg")}},{key:"enterChapterLoadingState",value:function(){this.loadingMessage=(0,v.wi)(this.localization)({getNode:!0}),this.pctElm=this.loadingMessage.querySelector(".".concat(Tt)),(0,a.Z)((0,l.Z)(e.prototype),"enterChapterLoadingState",this).call(this)}},{key:"onBatchAssetLoaderProgress",value:function(){this.pctElm.textContent=parseInt(100*this.batchAssetLoader.currentBatchStatus.batchProgress,10)}},{key:"populateTemplate",value:function(){this.element=(0,y.B8)(this.chapterData.data,this.localization)({getNode:!0}),this.cacheDOM(),this.loadExteriorTemplate(),this.loadInteriorTemplate(),this.loadModelLoadingTemplate(),this.element.querySelector(".".concat(Lt)).classList.add(kt),this.cacheThreeSixtys(),(0,a.Z)((0,l.Z)(e.prototype),"populateTemplate",this).call(this)}},{key:"loadInteriorTemplate",value:function(){this.interiorTemplate=h.jG.fromTemplate((0,y.yJ)(this.chapterData.data.amgInteriorTiles[this.modelIndex],this.localization)({getNode:!1})),this.sectionInteriorWrapper.appendChild(this.interiorTemplate),this.modelIndexInterior=this.modelIndex}},{key:"loadExteriorTemplate",value:function(){var t=window.mbNafta.ns("pageData","variantInfo").isLargeFormat;this.exteriorTemplate=h.jG.fromTemplate((0,y.Om)(this.chapterData.data.amgInteriorTiles[this.modelIndex],this.localization,!t)({getNode:!1})),this.sectionExteriorWrapper.appendChild(this.exteriorTemplate),this.modelIndexExterior=this.modelIndex}},{key:"loadModelLoadingTemplate",value:function(){this.loadingModelMessage=(0,y.Iz)()({getNode:!0}),h.jG.append(this.loadingModelMessage,this.sectionWrapper),this.modelPctElm=this.loadingModelMessage.querySelector(".".concat(Tt))}},{key:"cacheDOM",value:function(){this.chapterWrapperInnerElm=this.element.querySelector(".".concat("specialty-chapter__wrapper-inner")),this.headingElm=this.element.querySelector(".".concat("chapter-design__heading")),this.modelsCtaElm=this.element.querySelector(".".concat("chapter-design__models-cta")),this.sectionToggleWrapperElm=this.element.querySelector(".".concat("chapter-design__section-toggle")),this.sectionToggleButtonElms=(0,F.Z)(this.element.querySelectorAll(".".concat("chapter-design__section-toggle-button"))),this.sectionWrapper=this.element.querySelector(".".concat("chapter-design__section-wrapper")),this.sectionInteriorWrapper=this.element.querySelector(".".concat("chapter-design__section-interior-wrapper")),this.sectionExteriorWrapper=this.element.querySelector(".".concat("chapter-design__section-exterior-wrapper")),this.navigationWrapperElm=this.element.querySelector(".".concat("chapter-design__navigation-wrapper")),(0,a.Z)((0,l.Z)(e.prototype),"cacheDOM",this).call(this)}},{key:"cacheThreeSixtys",value:function(){this.sectionElms=(0,F.Z)(this.element.querySelectorAll(".".concat(Ct))),this.exteriorElm=this.element.querySelector(".".concat(Lt)),this.interiorElm=this.element.querySelector(".".concat("chapter-design__section-interior"))}},{key:"registerAnimationElements",value:function(){m.Z.playinFinish=this.onAnimElemPlayinComplete,m.Z.playoutFinish=this.onAnimElemPlayoutComplete;var t=h.sp.getCurrentState(),i="small"===t?st.Z.headingPlayinSm:st.Z.headingPlayinLg,n="small"===t?st.Z.headingPlayoutSm:st.Z.headingPlayoutLg;this.animationElements[Dt]=new m.Z(this.headingElm,{id:Dt,animationPlayin:i,animationPlayout:n}),i="small"===t?st.Z.modelsCtaPlayinSm:st.Z.modelsCtaPlayinLg,n="small"===t?st.Z.modelsCtaPlayoutSm:st.Z.modelsCtaPlayoutLg,this.animationElements[Ot]=new m.Z(this.modelsCtaElm,{id:Ot,animationPlayin:i,animationPlayout:n}),this.animationElements[Zt]=new m.Z(this.sectionToggleWrapperElm,{id:Zt,animationPlayin:st.Z.togglesPlayin,animationPlayout:st.Z.togglesPlayout}),this.animationElements[xt]=new m.Z(this.sectionWrapper,{id:xt,animationPlayout:st.Z.sectionWrapperPlayout}),this.animationElements[wt]=new m.Z(this.navigationWrapperElm,{id:wt,animationPlayin:st.Z.modelsNavPlayin,animationPlayout:st.Z.modelsNavPlayout}),(0,a.Z)((0,l.Z)(e.prototype),"registerAnimationElements",this).call(this)}},{key:"attachEvents",value:function(){var t,i=this;null===(t=this.sectionToggleButtonElms)||void 0===t||t.forEach((function(t){t.addEventListener(c.FP.CLICK,i.onToggleButtonClick)})),(0,a.Z)((0,l.Z)(e.prototype),"attachEvents",this).call(this)}},{key:"detachEvents",value:function(){var t,i=this;null===(t=this.sectionToggleButtonElms)||void 0===t||t.forEach((function(t){t.removeEventListener(c.FP.CLICK,i.onToggleButtonClick)})),(0,a.Z)((0,l.Z)(e.prototype),"detachEvents",this).call(this)}},{key:"beginPlayin",value:function(){this.isErrorState||(this.renderExterior(),this.renderInterior(),this.addModelsNavigation()),(0,a.Z)((0,l.Z)(e.prototype),"beginPlayin",this).call(this)}},{key:"renderExterior",value:function(){this.AMGDesignExterior=new ft(this.exteriorTemplate,this.chapterData.data.amgInteriorTiles[this.modelIndex],this.exteriorImages,this.appDamUrlPrefix,this.localization)}},{key:"renderInterior",value:function(){this.AMGDesignInterior=new pt(this.interiorTemplate,this.chapterData.data.amgInteriorTiles[this.modelIndex],this.appDamUrlPrefix,this.localization)}},{key:"addModelsNavigation",value:function(){var t=[];this.chapterData.data.amgInteriorTiles.forEach((function(e){t.push(e.modelDisplayName)})),this.navigation=new I.W_(t,this.navigationWrapperElm,this.onModelNavigationClick,{className:"chapter-design__navigation"},this.localization)}},{key:"onToggleButtonClick",value:function(){this.isExterior=!this.isExterior,this.modelIndexInterior!==this.modelIndexExterior&&(this[this.isExterior?"sectionExteriorWrapper":"sectionInteriorWrapper"].classList.add(At),this.enterModelLoadingState(),this.sectionElms=(0,F.Z)(this.element.querySelectorAll(".".concat(Ct)))),this.sectionToggleButtonElms.forEach((function(t){t.classList.toggle("chapter-design__section-toggle-button--selected"),t.hasAttribute(Mt)?t.removeAttribute(Mt):t.setAttribute(Mt,"-1")})),this.isExterior?(this.AMGDesignInterior.deactivate(),this.AMGDesignExterior.activate(),this.sectionElms.forEach((function(t){t.classList.toggle(kt)}))):(this.observer=new MutationObserver(this.onInteriorMutation),this.observer.observe(this.interiorTemplate,{childList:!0,subtree:!0}),this.AMGDesignInterior.activate(),this.AMGDesignExterior.deactivate())}},{key:"onInteriorMutation",value:function(){this.observer.disconnect(),this.sectionElms.forEach((function(t){t.classList.toggle(kt)}))}},{key:"onModelNavigationClick",value:function(t){this.modelIndex=t>=0?t:this.modelIndex,this.assetsToLoad=[].concat((0,F.Z)(this.collectExteriorImages()),[this.getInteriorImage()]),this.enterModelLoadingState()}},{key:"enterModelLoadingState",value:function(){this.modelPctElm.textContent="0",this.loadingModelMessage.addEventListener(c.FP.TRANSITION_END,this.onModelLoadingPlayinTransitionEnd),this.loadingModelMessage.classList.add(Pt),this.sectionToggleWrapperElm.classList.add(bt),this.navigation.disableNavigation()}},{key:"onModelLoadingPlayinTransitionEnd",value:function(){this.prepBatchModelAssetLoader(),this.loadModelAssets(),this.loadingModelMessage.removeEventListener(c.FP.TRANSITION_END,this.onModelLoadingPlayinTransitionEnd)}},{key:"prepBatchModelAssetLoader",value:function(){this.batchModelAssetLoader=new h.XK({progress:this.onBatchModelAssetLoaderProgress,abort:this.onBatchModelAssetLoaderAbort,error:this.onBatchModelAssetLoaderError,complete:this.onBatchModelAssetLoaderComplete})}},{key:"loadModelAssets",value:function(){this.batchModelLoadAssets=this.batchModelAssetLoader.loadAssets(this.assetsToLoad,this.batchAssetLoaderMethod)}},{key:"onBatchModelAssetLoaderProgress",value:function(){this.modelPctElm.textContent=parseInt(100*this.batchModelAssetLoader.currentBatchStatus.batchProgress,10)}},{key:"onBatchModelAssetLoaderAbort",value:function(t){console.log("\nonBatchAssetLoaderAbort",t)}},{key:"onBatchModelAssetLoaderError",value:function(t){console.log("\nonBatchAssetLoaderError",t)}},{key:"onBatchModelAssetLoaderComplete",value:function(){this.exitModelLoadingState()}},{key:"exitModelLoadingState",value:function(){this.loadingModelMessage.classList.remove(Pt),!this.isExterior&&this.interiorTemplate&&this.sectionInteriorWrapper.contains(this.interiorTemplate)&&("0"!==window.getComputedStyle(this.sectionInteriorWrapper).opacity?(this.sectionInteriorWrapper.addEventListener(c.FP.TRANSITION_END,this.onModelLoadingPlayoutTransitionEnd),this.sectionInteriorWrapper.classList.add(It)):this.onModelLoadingPlayoutTransitionEnd()),this.isExterior&&this.exteriorTemplate&&this.sectionExteriorWrapper.contains(this.exteriorTemplate)&&("0"!==window.getComputedStyle(this.sectionExteriorWrapper).opacity?(this.sectionExteriorWrapper.addEventListener(c.FP.TRANSITION_END,this.onModelLoadingPlayoutTransitionEnd),this.sectionExteriorWrapper.classList.add(It)):this.onModelLoadingPlayoutTransitionEnd()),this.sectionToggleWrapperElm.classList.remove(bt)}},{key:"onModelLoadingPlayoutTransitionEnd",value:function(){this.isExterior?(this.removeExterior(),this.loadExteriorTemplate(),this.cacheThreeSixtys(),this.exteriorElm.classList.add(St),this.renderExterior(),this.exteriorElm.classList.add(kt)):(this.removeInterior(),this.loadInteriorTemplate(),this.cacheThreeSixtys(),this.interiorElm.classList.add(St),this.renderInterior(),this.interiorElm.classList.add(kt),this.AMGDesignInterior.activate()),this.newModelPlayin()}},{key:"newModelPlayin",value:function(){this.sectionElms.forEach((function(t){t.classList.remove(St)})),this.sectionExteriorWrapper.removeEventListener(c.FP.TRANSITION_END,this.onModelLoadingPlayoutTransitionEnd),this.sectionInteriorWrapper.removeEventListener(c.FP.TRANSITION_END,this.onModelLoadingPlayoutTransitionEnd),this.sectionInteriorWrapper.classList.remove(It),this.sectionExteriorWrapper.classList.remove(It),this.sectionInteriorWrapper.classList.remove(At),this.sectionExteriorWrapper.classList.remove(At),this.navigation.enableNavigation()}},{key:"removeExterior",value:function(){h.jG.empty(this.sectionExteriorWrapper),this.exteriorTemplate=null}},{key:"removeInterior",value:function(){this.AMGDesignInterior.destroy(),h.jG.empty(this.sectionInteriorWrapper),this.interiorTemplate=null}},{key:"destroy",value:function(){var t,i;null===(t=this.AMGDesignInterior)||void 0===t||t.destroy(),null===(i=this.navigation)||void 0===i||i.destroy(),(0,a.Z)((0,l.Z)(e.prototype),"destroy",this).call(this)}}]),e}(p.Z),Ft=i(51571),_t=i(4942);function Nt(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function Rt(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(i),!0).forEach((function(e){(0,_t.Z)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Nt(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var Ht=function(){function t(e,i,s,o,a){(0,n.Z)(this,t),this.itemData=e,this.itemIndex=i,this.lastIndex=s,this.clickCallback=o,this.tabKeypressCallback=a,this.init()}return(0,s.Z)(t,[{key:"setBindings",value:function(){this.onItemContentClick=this.onItemContentClick.bind(this),this.onItemContentKeypress=this.onItemContentKeypress.bind(this),this.onTileKeypress=this.onTileKeypress.bind(this)}},{key:"cacheDOM",value:function(){this.sliderItemContent=this.element.querySelector(".".concat("slider-item__displayed-content"))}},{key:"attachEvents",value:function(){this.sliderItemContent.addEventListener(c.FP.MOUSEDOWN,this.onItemContentClick),this.sliderItemContent.addEventListener(c.FP.KEYPRESS,this.onItemContentKeypress),this.sliderItemContent.addEventListener(c.FP.KEYDOWN,this.onItemContentKeypress),this.element.addEventListener(c.FP.KEYPRESS,this.onTileKeypress),this.element.addEventListener(c.FP.KEYDOWN,this.onTileKeypress)}},{key:"detachEvents",value:function(){this.sliderItemContent.removeEventListener(c.FP.MOUSEDOWN,this.onItemContentClick),this.sliderItemContent.removeEventListener(c.FP.KEYPRESS,this.onItemContentKeypress),this.sliderItemContent.removeEventListener(c.FP.KEYDOWN,this.onItemContentKeypress),this.element.removeEventListener(c.FP.KEYPRESS,this.onTileKeypress),this.element.removeEventListener(c.FP.KEYDOWN,this.onTileKeypress)}},{key:"onTileKeypress",value:function(t){t.keyCode!==c.sd.RIGHT&&t.keyCode!==c.sd.LEFT||(t.preventDefault(),t.stopPropagation(),this.tabKeypressCallback(t))}},{key:"removeFocusFromTile",value:function(){this.updateState({focusElement:null})}},{key:"setFocusOnTile",value:function(){this.setFocusOnTileContent()}},{key:"setFocusOnTileContent",value:function(){this.sliderItemContent.focus(),this.updateState({focusElement:"tile"})}},{key:"updateIndices",value:function(t){var e=t.itemIndex,i=t.lastIndex;void 0!==e&&(this.itemIndex=e),void 0!==i&&(this.lastIndex=i)}},{key:"updateState",value:function(t){this.state=Rt({},this.state,{},t)}},{key:"getState",value:function(){return Rt({},this.state)}},{key:"destroy",value:function(){this.detachEvents()}},{key:"render",value:function(){return this.element}}]),t}(),Vt="slider-item--open",Kt=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"init",value:function(){this.state={inView:!1,isOpen:!1,pageScrollingLocked:!1,focusElement:null},this.isDDTVariant=window.mbNafta.ns("pageData","variantInfo").isDDTVariant,this.setBindings(),this.populateTemplate(),this.cacheDOM(),this.attachEvents()}},{key:"setBindings",value:function(){this.onCloseClick=this.onCloseClick.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onCloseKeypress=this.onCloseKeypress.bind(this),this.onTitleKeypress=this.onTitleKeypress.bind(this),(0,a.Z)((0,l.Z)(e.prototype),"setBindings",this).call(this)}},{key:"populateTemplate",value:function(){this.element=(0,y.vl)(this.itemData,this.isDDTVariant)({getNode:!0})}},{key:"cacheDOM",value:function(){this.sliderClose=this.element.querySelector(".".concat("slider-item__close")),this.sliderItemDetailedContent=this.element.querySelector(".".concat("slider-item__description-content")),this.sliderItemDetailedTitle=this.element.querySelector(".".concat("slider-item__description-title")),this.sliderItemDetailedCta=this.element.querySelector(".".concat("slider-item__description-cta")),(0,a.Z)((0,l.Z)(e.prototype),"cacheDOM",this).call(this)}},{key:"attachEvents",value:function(){this.sliderItemDetailedTitle.addEventListener(c.FP.KEYPRESS,this.onTitleKeypress),this.sliderItemDetailedTitle.addEventListener(c.FP.KEYDOWN,this.onTitleKeypress),this.sliderClose.addEventListener(c.FP.CLICK,this.onCloseClick),this.sliderClose.addEventListener(c.FP.KEYPRESS,this.onCloseKeypress),this.sliderClose.addEventListener(c.FP.KEYDOWN,this.onCloseKeypress),this.sliderItemDetailedContent.addEventListener(c.FP.MOUSEENTER,this.onMouseEnter),this.sliderItemDetailedContent.addEventListener(c.FP.MOUSELEAVE,this.onMouseLeave),(0,a.Z)((0,l.Z)(e.prototype),"attachEvents",this).call(this)}},{key:"detachEvents",value:function(){this.sliderItemDetailedTitle.removeEventListener(c.FP.KEYPRESS,this.onTitleKeypress),this.sliderItemDetailedTitle.removeEventListener(c.FP.KEYDOWN,this.onTitleKeypress),this.sliderClose.removeEventListener(c.FP.CLICK,this.onCloseClick),this.sliderClose.removeEventListener(c.FP.KEYPRESS,this.onCloseKeypress),this.sliderClose.removeEventListener(c.FP.KEYDOWN,this.onCloseKeypress),this.sliderItemDetailedContent.removeEventListener(c.FP.MOUSEENTER,this.onMouseEnter),this.sliderItemDetailedContent.removeEventListener(c.FP.MOUSELEAVE,this.onMouseLeave),(0,a.Z)((0,l.Z)(e.prototype),"detachEvents",this).call(this)}},{key:"onItemContentClick",value:function(){this.openDrawer()}},{key:"onItemContentKeypress",value:function(t){t.keyCode===c.sd.TAB&&(t.shiftKey&&0===this.itemIndex||!t.shiftKey&&this.itemIndex===this.lastIndex)||(t.keyCode===c.sd.ENTER?(t.preventDefault(),t.stopPropagation(),this.openDrawer()):t.keyCode===c.sd.TAB&&(t.preventDefault(),t.stopPropagation(),!t.shiftKey&&this.getState().hasVideo?this.setFocusOnVideo():this.tabKeypressCallback(t)))}},{key:"onTitleKeypress",value:function(t){t.keyCode===c.sd.TAB&&(t.preventDefault(),t.stopPropagation(),t.shiftKey?this.setFocusOnTileContent():this.sliderItemDetailedCta?this.setFocusOnCta():this.setFocusOnClose())}},{key:"onCloseClick",value:function(){this.closeDrawer(),this.clickCallback(this.itemIndex)}},{key:"openDrawer",value:function(){this.clickCallback(this.itemIndex),this.updateState({isOpen:!0}),this.element.setAttribute("aria-expanded","true"),this.element.classList.add(Vt),"tile"===this.getState().focusElement&&this.setFocusOnTitle()}},{key:"closeDrawer",value:function(){this.updateState({isOpen:!1}),this.element.setAttribute("aria-expanded","false"),this.element.classList.remove(Vt),this.unlockPageScrollTouch()}},{key:"onCloseKeypress",value:function(t){t.keyCode===c.sd.ENTER?(t.preventDefault(),t.stopPropagation(),this.closeDrawer(),this.setFocusOnTileContent()):t.keyCode===c.sd.TAB&&(t.preventDefault(),t.stopPropagation(),t.shiftKey?this.sliderItemDetailedCta?this.setFocusOnCta():this.setFocusOnTitle():this.tabKeypressCallback(t))}},{key:"onMouseEnter",value:function(){this.testOverflow()&&this.lockPageScroll()}},{key:"onMouseLeave",value:function(){this.getState().pageScrollingLocked&&this.unlockPageScroll()}},{key:"setFocusOnTitle",value:function(){this.sliderItemDetailedTitle.focus(),this.updateState({focusElement:"title"})}},{key:"setFocusOnTile",value:function(){this.getState().isOpen?this.setFocusOnTitle():this.setFocusOnTileContent()}},{key:"setFocusOnCta",value:function(){this.sliderItemDetailedCta.focus(),this.updateState({focusElement:"cta"})}},{key:"setFocusOnClose",value:function(){this.sliderClose.focus(),this.updateState({focusElement:"close"})}},{key:"setFocusOnVideo",value:function(){this.sliderVideo.focus(),this.updateState({focusElement:"video"})}},{key:"testOverflow",value:function(){return this.sliderItemDetailedContent.scrollHeight>this.sliderItemDetailedContent.clientHeight}},{key:"lockPageScroll",value:function(){this.updateState({pageScrollingLocked:!0}),h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.SPECIALTY_PAGE_LOCK_SCROLL))}},{key:"unlockPageScroll",value:function(){this.updateState({pageScrollingLocked:!1}),h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.SPECIALTY_PAGE_UNLOCK_SCROLL))}},{key:"lockPageScrollTouch",value:function(){h.Xh.isTouch()&&this.testOverflow()&&this.lockPageScroll()}},{key:"unlockPageScrollTouch",value:function(){h.Xh.isTouch()&&this.getState().pageScrollingLocked&&this.unlockPageScroll()}},{key:"handleTouchScroll",value:function(){this.getState().focusElement?this.getState().isOpen&&this.lockPageScrollTouch():this.unlockPageScrollTouch()}},{key:"destroy",value:function(){this.getState().pageScrollingLocked&&this.unlockPageScroll(),(0,a.Z)((0,l.Z)(e.prototype),"destroy",this).call(this)}},{key:"updateState",value:function(t){(0,a.Z)((0,l.Z)(e.prototype),"updateState",this).call(this,t),Object.prototype.hasOwnProperty.call(t,"focusElement")&&this.handleTouchScroll()}}]),e}(Ht),zt="chapterHistory",Wt=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"setBindings",value:function(){this.onAnimElemPlayinComplete=this.onAnimElemPlayinComplete.bind(this),this.onAnimElemPlayoutComplete=this.onAnimElemPlayoutComplete.bind(this),this.createSlider=this.createSlider.bind(this),(0,a.Z)((0,l.Z)(e.prototype),"setBindings",this).call(this)}},{key:"init",value:function(){this.currentScreenState=h.sp.getCurrentState(),this.assetsToLoad=(0,F.Z)(this.collectHistoryImages()),this.batchAssetLoaderMethod=h.XK.REQUEST_METHODS.GET,(0,a.Z)((0,l.Z)(e.prototype),"init",this).call(this)}},{key:"collectHistoryImages",value:function(){for(var t=[],e=0,i=this.chapterData.data.timelineTiles.length,n="small"===this.currentScreenState?"imgSmall":"imgLarge";e<i;e+=1)if(this.chapterData.data.timelineTiles[e][n]){var s=this.chapterData.data.timelineTiles[e][n].path||this.chapterData.data.timelineTiles[e].imgLarge.path;t.push(s)}return t}},{key:"enterChapterLoadingState",value:function(){this.loadingMessage=(0,v.wi)(this.localization)({getNode:!0}),this.pctElm=this.loadingMessage.querySelector(".".concat("specialty-chapter__loading-pct")),(0,a.Z)((0,l.Z)(e.prototype),"enterChapterLoadingState",this).call(this)}},{key:"onBatchAssetLoaderProgress",value:function(){this.pctElm.textContent=parseInt(100*this.batchAssetLoader.currentBatchStatus.batchProgress,10)}},{key:"populateTemplate",value:function(){this.element=(0,y.Cc)(this.chapterData.data,this.localization)({getNode:!0}),this.cacheDOM(),this.createSlider(),(0,a.Z)((0,l.Z)(e.prototype),"populateTemplate",this).call(this)}},{key:"createSlider",value:function(){this.slider=new I.X9(this.chapterData.data.timelineTiles,Kt),h.jG.append(this.slider.render(),this.element)}},{key:"registerAnimationElements",value:function(){m.Z.playinFinish=this.onAnimElemPlayinComplete,m.Z.playoutFinish=this.onAnimElemPlayoutComplete,this.animationElements[zt]=new m.Z(this.element.querySelector(".".concat("slider__wrapper")),{id:zt,animationPlayin:Ft.Z.historyPlayin,animationPlayout:Ft.Z.historyPlayout}),(0,a.Z)((0,l.Z)(e.prototype),"registerAnimationElements",this).call(this)}},{key:"setInitialChapterFocus",value:function(){return!1}},{key:"destroy",value:function(){this.slider&&this.slider.destroy(),(0,a.Z)((0,l.Z)(e.prototype),"destroy",this).call(this)}}]),e}(p.Z),jt=i(79645),Ut="gallery-filters__wrapper--drop-down",qt="gallery-filters__toggle-button--active",Gt="gallery-filters__list--open",Yt="gallery-filters__button--selected",Jt="tabindex",Xt="aria-hidden",Qt="aria-expanded",$t="aria-label",te={large:620,xlarge:860,xxlarge:860},ee=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.ZT,s=arguments.length>2?arguments[2]:void 0;(0,n.Z)(this,t),this.data=e,this.updateCallback=i,this.currentScreenState=null,this.filtersState={},this.filtersSelected=0,this.menuOpen=!1,this.localization=s,this.init()}return(0,s.Z)(t,[{key:"init",value:function(){this.initFiltersState(),this.setBindings(),this.populateTemplate(),this.cacheDOM(),this.attachEvents(),this.onResize()}},{key:"initFiltersState",value:function(){var t=this;this.data.forEach((function(e){t.filtersState[e.value]=!1}))}},{key:"setBindings",value:function(){this.onToggleButtonFocus=this.onToggleButtonFocus.bind(this),this.onToggleButtonBlur=this.onToggleButtonBlur.bind(this),this.onFilterButtonClick=this.onFilterButtonClick.bind(this),this.onResize=this.onResize.bind(this),this.testStripWidth=this.testStripWidth.bind(this)}},{key:"populateTemplate",value:function(){this.element=(0,y.dd)(this.data,this.localization)({getNode:!0})}},{key:"cacheDOM",value:function(){this.toggleButtonElm=this.element.querySelector(".".concat("gallery-filters__toggle-button")),this.toggleButtonCountElm=this.element.querySelector(".".concat("gallery-filters__count")),this.filterListElm=this.element.querySelector(".".concat("gallery-filters__list")),this.filterButtonElms=(0,F.Z)(this.element.querySelectorAll(".".concat("gallery-filters__button"))),this.co=new h.Lp(this.toggleButtonElm,this.onToggleButtonFocus,this.onToggleButtonBlur)}},{key:"attachEvents",value:function(){var t=this;this.toggleButtonElm.addEventListener(c.FP.CLICK,this.onToggleButtonClick),this.filterButtonElms.forEach((function(e){e.addEventListener(c.FP.CLICK,t.onFilterButtonClick)})),h.sp.addResizeListener(this.onResize)}},{key:"detachEvents",value:function(){var t=this;this.toggleButtonElm.removeEventListener(c.FP.CLICK,this.onToggleButtonClick),this.filterButtonElms.forEach((function(e){e.removeEventListener(c.FP.CLICK,t.onFilterButtonClick)})),h.sp.removeResizeListener(this.onResize)}},{key:"onResize",value:function(){this.currentScreenState!==h.sp.getCurrentState()&&(this.menuOpen&&this.closeMenu(),this.currentScreenState=h.sp.getCurrentState(),this.setInitialMenuStyle())}},{key:"onToggleButtonFocus",value:function(){this.menuOpen?this.closeMenu():this.openMenu()}},{key:"onToggleButtonBlur",value:function(){this.menuOpen&&this.closeMenu()}},{key:"openMenu",value:function(){this.toggleButtonElm.classList.add(qt),this.toggleButtonElm.setAttribute(Qt,"true"),this.filterListElm.classList.add(Gt),this.filterListElm.setAttribute(Xt,"false"),this.filterButtonElms.forEach((function(t,e){t.removeAttribute(Jt),0===e&&t.focus()})),this.menuOpen=!0}},{key:"closeMenu",value:function(){this.toggleButtonElm.classList.remove(qt),this.toggleButtonElm.setAttribute(Qt,"false"),this.filterListElm.classList.remove(Gt),this.filterListElm.setAttribute(Xt,"true"),this.filterButtonElms.forEach((function(t){t.setAttribute(Jt,"-1")})),this.menuOpen=!1}},{key:"onFilterButtonClick",value:function(t){var e=t.currentTarget;e.classList.contains(Yt)?(e.classList.remove(Yt),e.setAttribute($t,"".concat(e.dataset.filterName))):(e.classList.add(Yt),e.setAttribute($t,"".concat(e.dataset.filterName," ").concat(this.localization.selected))),this.updateFilteredSet(),this.updateCallback(this.filtersState)}},{key:"updateFilteredSet",value:function(){var t=this,e=0;this.filterButtonElms.forEach((function(i){i.classList.contains(Yt)?(t.filtersState[i.dataset.filterName]=!0,e+=1):t.filtersState[i.dataset.filterName]=!1})),this.filtersSelected=e,this.toggleButtonCountElm.textContent=e}},{key:"setInitialMenuStyle",value:function(){h.sp.gte(h.sp.SIZES.LARGE)?this.setStripStyle():this.setDropDownStyle()}},{key:"setStripStyle",value:function(){this.element.classList.remove(Ut),this.filterListElm.setAttribute(Xt,"false"),this.filterButtonElms.forEach((function(t){t.removeAttribute(Jt)})),window.requestAnimationFrame(this.testStripWidth)}},{key:"setDropDownStyle",value:function(){this.element.classList.add(Ut),this.filterListElm.setAttribute(Xt,"true"),this.filterButtonElms.forEach((function(t){t.setAttribute(Jt,"-1")}))}},{key:"testStripWidth",value:function(){this.filterListElm.offsetWidth>te[this.currentScreenState]&&this.setDropDownStyle()}},{key:"render",value:function(){return this.element}},{key:"destroy",value:function(){this.detachEvents()}}]),t}(),ie=i(94151),ne=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"init",value:function(){this.state={inView:!1,isOpen:!1,focusElement:null,filtered:!1},this.filterTags=this.itemData.tags.join(","),this.setBindings(),this.populateTemplate(),this.cacheDOM(),this.attachEvents()}},{key:"populateTemplate",value:function(){this.element=(0,y.pd)(this.itemData)({getNode:!0})}},{key:"onItemContentClick",value:function(t){t.preventDefault(),t.stopPropagation(),this.openModal()}},{key:"onItemContentKeypress",value:function(t){t.keyCode===c.sd.TAB&&(t.shiftKey&&0===this.itemIndex||!t.shiftKey&&this.itemIndex===this.lastIndex)||(t.keyCode===c.sd.ENTER?(t.preventDefault(),t.stopPropagation(),this.openModal()):t.keyCode===c.sd.TAB&&(t.preventDefault(),t.stopPropagation(),this.tabKeypressCallback(t)))}},{key:"openModal",value:function(){console.log("openModal()"),this.clickCallback(this.itemIndex)}},{key:"setFilteredState",value:function(t){var e=this;if(!0===t)this.updateState({filtered:!1}),this.element.dataset.filtered=!1,this.sliderItemContent.setAttribute("aria-hidden",!1),this.sliderItemContent.removeAttribute("tabindex");else{var i=Object.keys(t).some((function(i){return!!(t[i]&&e.filterTags.indexOf(i)>-1)}));this.updateState({filtered:!i}),this.element.dataset.filtered=!i,this.sliderItemContent.setAttribute("aria-hidden",!i),i?this.sliderItemContent.removeAttribute("tabindex"):this.sliderItemContent.setAttribute("tabindex",-1)}return this.getState().filtered}}]),e}(Ht);function se(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function oe(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?se(Object(i),!0).forEach((function(e){(0,_t.Z)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):se(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var ae="modal--specialty-gallery-carousel--pre-limiter",le="modal--specialty-gallery-carousel--height-limiter",re="chapterGallery",he="filterTags",ce=function(t){function e(t){var i;return(0,n.Z)(this,e),(i=(0,o.Z)(this,(0,l.Z)(e).call(this,t))).modalData=[],i.carouselModal=null,i.state={index:null,pageScrollingLocked:!1},i}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"setBindings",value:function(){this.onAnimElemPlayinComplete=this.onAnimElemPlayinComplete.bind(this),this.onAnimElemPlayoutComplete=this.onAnimElemPlayoutComplete.bind(this),this.createSlider=this.createSlider.bind(this),this.createModalData=this.createModalData.bind(this),this.openCarouselModal=this.openCarouselModal.bind(this),this.onSlideCallback=this.onSlideCallback.bind(this),this.onAfterCarouselOpen=this.onAfterCarouselOpen.bind(this),this.onBeforeCarouselClose=this.onBeforeCarouselClose.bind(this),this.onResize=this.onResize.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onFilterUpdate=this.onFilterUpdate.bind(this),this.testOverlayDimensionLimiter=this.testOverlayDimensionLimiter.bind(this),(0,a.Z)((0,l.Z)(e.prototype),"setBindings",this).call(this)}},{key:"init",value:function(){this.currentScreenState=h.sp.getCurrentState(),this.assetsToLoad=(0,F.Z)(this.collectGalleryImages()),this.batchAssetLoaderMethod=h.XK.REQUEST_METHODS.GET,(0,a.Z)((0,l.Z)(e.prototype),"init",this).call(this)}},{key:"collectGalleryImages",value:function(){for(var t=[],e=0,i=this.chapterData.data.galleryTiles.length,n="small"===this.currentScreenState?"imgSmall":"imgLarge";e<i;e+=1)if(this.chapterData.data.galleryTiles[e][n]){var s=this.chapterData.data.galleryTiles[e][n].path||this.chapterData.data.galleryTiles[e].imgLarge.path;t.push(s),t.push(this.chapterData.data.galleryTiles[e].overlayImage.path)}return t}},{key:"enterChapterLoadingState",value:function(){this.loadingMessage=(0,v.wi)(this.localization)({getNode:!0}),this.pctElm=this.loadingMessage.querySelector(".".concat("specialty-chapter__loading-pct")),(0,a.Z)((0,l.Z)(e.prototype),"enterChapterLoadingState",this).call(this)}},{key:"onBatchAssetLoaderProgress",value:function(){this.pctElm.textContent=parseInt(100*this.batchAssetLoader.currentBatchStatus.batchProgress,10)}},{key:"populateTemplate",value:function(){this.element=(0,y.HP)()({getNode:!0}),this.cacheDOM(),this.createFilterTags(),this.createSlider(),(0,a.Z)((0,l.Z)(e.prototype),"populateTemplate",this).call(this)}},{key:"cacheDOM",value:function(){this.chapterGalleryElm=this.element.querySelector(".".concat("slider__wrapper")),this.filtersOuterWrapperElm=this.element.querySelector(".".concat("gallery-filters__outer-wrapper")),this.sliderOuterWrapperElm=this.element.querySelector(".".concat("chapter-gallery__slider-outer-wrapper")),(0,a.Z)((0,l.Z)(e.prototype),"cacheDOM",this).call(this)}},{key:"createFilterTags",value:function(){var t=this.chapterData.data.galleryTiles.map((function(t){return t.tags.join(",")})).join(","),e=this.chapterData.data.filterTags.filter((function(e){return t.indexOf(e.value)>=0}));this.filters=new ee(e,this.onFilterUpdate,this.localization),h.jG.append(this.filters.render(),this.filtersOuterWrapperElm)}},{key:"createSlider",value:function(){this.slider=new I.X9(this.chapterData.data.galleryTiles,ne,{modifierClass:"gallery",clickCallback:this.openCarouselModal}),h.jG.append(this.slider.render(),this.sliderOuterWrapperElm)}},{key:"createModalData",value:function(){this.modalData=this.slider.unfilteredSliderItems.map((function(t){return{title:t.itemData.captionHeading.toUpperCase(),description:t.itemData.captionDescription,descriptionContainer:!0,imageUrl:t.itemData.overlayImage.path,imageAlt:t.itemData.imgAltText}}))}},{key:"openCarouselModal",value:function(t){this.slider.setOverlayMode(!0),this.createModalData();var e={carousel:{startIndex:t,onSlideCallback:this.onSlideCallback,onAfterOpen:this.onAfterCarouselOpen,onBeforeClose:this.onBeforeCarouselClose},modal:{sizeSmall:u.Modal.SIZES.INSET,sizeLarge:u.Modal.SIZES.INSET,transitionInOut:!0,theme:"specialty-gallery-carousel",themeModifier:"specialty-gallery-carousel--pre-limiter"}};this.carouselModal=new jt.s(this.modalData,e),this.carouselModal.open(),this.attachOverlayEvents(t)}},{key:"onAfterCarouselOpen",value:function(t){this.modalNode=t,this.testOverlayDimensionLimiter()}},{key:"onBeforeCarouselClose",value:function(){this.slider.setOverlayMode(!1),this.detachOverlayEvents()}},{key:"testOverlayDimensionLimiter",value:function(){var t=this.modalNode.querySelector(".".concat("carousel__slide--active"," .").concat("responsive-image"));if(t){if(0===t.clientHeight)return void requestAnimationFrame(this.testOverlayDimensionLimiter);var e=(window.innerWidth-60)/(window.innerHeight-60),i=this.modalNode.getBoundingClientRect();e>i.width/i.height?this.setHeightLimiter(t):this.setWidthLimiter()}}},{key:"setHeightLimiter",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.modalNode.classList.add(le);var i=t.clientHeight*t.naturalWidth/t.naturalHeight;this.modalNode.style.width="".concat(i,"px"),e?this.setHeightLimiter(t,!1):this.modalNode.classList.remove(ae)}},{key:"setWidthLimiter",value:function(){this.modalNode.classList.remove(le),this.modalNode.style.width=null,this.modalNode.classList.remove(ae)}},{key:"getSliderItemDetailContentElm",value:function(t){return this.carouselModal.carousel.slideItems[t].slide.querySelector(".".concat("modal-carousel__details-wrapper"))}},{key:"attachOverlayEvents",value:function(t){h.sp.addResizeListener(this.onResize),this.sliderItemDetailContent=this.getSliderItemDetailContentElm(t),this.sliderItemDetailContent.addEventListener(c.FP.TOUCHSTART,this.onTouchStart),this.sliderItemDetailContent.addEventListener(c.FP.TOUCHEND,this.onTouchEnd),this.sliderItemDetailContent.addEventListener(c.FP.MOUSEENTER,this.onMouseEnter),this.sliderItemDetailContent.addEventListener(c.FP.MOUSELEAVE,this.onMouseLeave)}},{key:"detachOverlayEvents",value:function(){h.sp.removeResizeListener(this.onResize),this.sliderItemDetailContent.removeEventListener(c.FP.TOUCHSTART,this.onTouchStart),this.sliderItemDetailContent.removeEventListener(c.FP.TOUCHEND,this.onTouchEnd),this.sliderItemDetailContent.removeEventListener(c.FP.MOUSEENTER,this.onMouseEnter),this.sliderItemDetailContent.removeEventListener(c.FP.MOUSELEAVE,this.onMouseLeave),this.sliderItemDetailContent=null}},{key:"onResize",value:function(){this.testOverlayDimensionLimiter()}},{key:"onTouchStart",value:function(){this.testOverflow()&&this.lockPageScroll()}},{key:"onTouchEnd",value:function(){this.getState().pageScrollingLocked&&(0,h.P2)(this.unlockPageScroll.bind(this),200)}},{key:"onMouseEnter",value:function(){this.testOverflow()&&this.lockPageScroll()}},{key:"onMouseLeave",value:function(){this.getState().pageScrollingLocked&&this.unlockPageScroll()}},{key:"testOverflow",value:function(){return this.sliderItemDetailContent.scrollHeight>this.sliderItemDetailContent.clientHeight}},{key:"lockPageScroll",value:function(){this.updateState({pageScrollingLocked:!0}),h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.SPECIALTY_PAGE_LOCK_SCROLL))}},{key:"unlockPageScroll",value:function(){this.updateState({pageScrollingLocked:!1}),h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.SPECIALTY_PAGE_UNLOCK_SCROLL))}},{key:"onFilterUpdate",value:function(t){this.slider.updateFilteredSet(t)}},{key:"registerAnimationElements",value:function(){m.Z.playinFinish=this.onAnimElemPlayinComplete,m.Z.playoutFinish=this.onAnimElemPlayoutComplete,this.animationElements[re]=new m.Z(this.chapterGalleryElm,{id:re,animationPlayin:ie.Z.galleryPlayin,animationPlayout:ie.Z.galleryPlayout}),this.animationElements[he]=new m.Z(this.filtersOuterWrapperElm,{id:he,animationPlayin:ie.Z.galleryPlayin,animationPlayout:ie.Z.galleryPlayout}),(0,a.Z)((0,l.Z)(e.prototype),"registerAnimationElements",this).call(this)}},{key:"onBeforeViolationModalOpen",value:function(){this.carouselModal&&this.carouselModal.close(!0),this.openSizeViolationModal()}},{key:"onSlideCallback",value:function(t){this.slider.goToTile(t),this.detachOverlayEvents(),this.attachOverlayEvents(t),this.testOverlayDimensionLimiter()}},{key:"updateState",value:function(t){this.state=oe({},this.state,{},t)}},{key:"getState",value:function(){return oe({},this.state)}},{key:"setInitialChapterFocus",value:function(){return!1}},{key:"destroy",value:function(){this.slider&&this.slider.destroy(),this.carouselModal&&this.carouselModal.close(),(0,a.Z)((0,l.Z)(e.prototype),"destroy",this).call(this)}}]),e}(p.Z),ue=i(352),de=i(63835),me=i(29819),pe="chapter-models__tabs-toggle-button--active",ve="chapter-models__tabs-list--open",ye="chapter-models__tab-item--active",Ee="chapter-models__tab-button--active",ge="tabindex",fe="aria-hidden",be="aria-expanded",Ce=function(){function t(e,i,s){(0,n.Z)(this,t),this.data=e,this.activeIndex=i,this.clickCallback=s,this.currentScreenState=null,this.setBindings()}return(0,s.Z)(t,[{key:"setBindings",value:function(){this.onScreenResize=this.onScreenResize.bind(this),this.onToggleButtonFocus=this.onToggleButtonFocus.bind(this),this.onToggleButtonBlur=this.onToggleButtonBlur.bind(this),this.onTabButtonClick=this.onTabButtonClick.bind(this)}},{key:"populateTemplate",value:function(t){this.container=t,this.element=(0,me.Z)(this.data,this.activeIndex)({getNode:!0}),h.jG.insert(this.element,this.container)}},{key:"cacheDOM",value:function(){this.toggleButtonElm=this.container.querySelector(".".concat("chapter-models__tabs-toggle-button")),this.tabsListElm=this.container.querySelector(".".concat("chapter-models__tabs-list")),this.tabButtonElms=(0,F.Z)(this.tabsListElm.querySelectorAll(".".concat("chapter-models__tab-button"))),this.co=new h.Lp(this.toggleButtonElm,this.onToggleButtonFocus,this.onToggleButtonBlur,{ignoreElems:this.tabsListElm})}},{key:"attachEvents",value:function(){var t=this;this.tabButtonElms.forEach((function(e){e.addEventListener(c.FP.CLICK,t.onTabButtonClick)})),h.sp.addResizeListener(this.onScreenResize),this.onScreenResize()}},{key:"detachEvents",value:function(){var t=this;h.sp.removeResizeListener(this.onScreenResize),this.tabButtonElms.forEach((function(e){e.removeEventListener(c.FP.CLICK,t.onTabButtonClick)}))}},{key:"openMenu",value:function(){this.toggleButtonElm.classList.add(pe),this.toggleButtonElm.setAttribute(be,"true"),this.tabsListElm.classList.add(ve),this.tabsListElm.setAttribute(fe,"false"),this.tabButtonElms.forEach((function(t){t.classList.contains(Ee)||t.removeAttribute(ge)})),this.tabButtonElms.find((function(t){return!t.classList.contains(Ee)})).focus()}},{key:"closeMenu",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.toggleButtonElm.classList.remove(pe),this.toggleButtonElm.setAttribute(be,"false"),t?this.toggleButtonElm.setAttribute(ge,"-1"):this.toggleButtonElm.removeAttribute(ge),this.tabsListElm.classList.remove(ve),this.tabsListElm.setAttribute(fe,t?"false":"true"),this.tabButtonElms.forEach((function(e){t?e.removeAttribute(ge):e.setAttribute(ge,"-1")}))}},{key:"onToggleButtonFocus",value:function(){this.toggleButtonElm.classList.contains(pe)?this.closeMenu():this.openMenu()}},{key:"onToggleButtonBlur",value:function(){this.closeMenu()}},{key:"onTabButtonClick",value:function(t){var e=this;this.activeIndex=parseInt(t.currentTarget.dataset.bodystyleIndex,10),this.toggleButtonElm.textContent=t.currentTarget.dataset.bodystyleName,this.tabButtonElms.forEach((function(t,i){t.classList.contains(Ee)?(t.classList.remove(Ee),t.parentNode.classList.remove(ye)):i===e.activeIndex&&(t.classList.add(Ee),t.parentNode.classList.add(ye))})),this.closeMenu(),this.clickCallback(this.activeIndex)}},{key:"onScreenResize",value:function(){var t=h.sp.getCurrentState();this.currentScreenState!==t&&(this.currentScreenState=t,this.closeMenu(h.sp.gte(h.sp.SIZES.XLARGE)))}},{key:"destroy",value:function(){this.detachEvents(),this.co.destroy()}}]),t}(),ke=i(36651),Le=i(24583),Pe=i(21255),Te="chapter-models__item--loading",Se="chapter-models__item-inner--playout",Ie=function(){function t(e,i,s,o,a){(0,n.Z)(this,t),this.data=e,this.bodystyle=i,this.chapterIndex=s,this.setBindings(),this.prepBatchAssetLoader(),this.observer=new MutationObserver(this.onDomMutation),this.observerOptions={childList:!0,subtree:!0},this.localization=a,this.appDamUrlPrefix=o,this.isDDTVariant=window.mbNafta.ns("pageData","variantInfo").isDDTVariant}return(0,s.Z)(t,[{key:"setBindings",value:function(){this.onBatchAssetLoaderProgress=this.onBatchAssetLoaderProgress.bind(this),this.onBatchAssetLoaderComplete=this.onBatchAssetLoaderComplete.bind(this),this.onPlayinTransitionEnd=this.onPlayinTransitionEnd.bind(this),this.onPlayoutTransitionEnd=this.onPlayoutTransitionEnd.bind(this),this.onDomMutation=this.onDomMutation.bind(this),this.onImageLoaded=this.onImageLoaded.bind(this),this.onImageError=this.onImageError.bind(this),this.onLearnMoreClick=this.onLearnMoreClick.bind(this),this.onDisclaimerClick=this.onDisclaimerClick.bind(this)}},{key:"prepBatchAssetLoader",value:function(){this.batchAssetLoader=new h.XK({progress:this.onBatchAssetLoaderProgress,complete:this.onBatchAssetLoaderComplete})}},{key:"populateTemplate",value:function(t){this.container=this.container||t,this.element=(0,ke.Z)(this.data,this.bodystyle,this.localization,this.isDDTVariant,this.appDamUrlPrefix)({getNode:!0}),h.jG.insert(this.element,this.container)}},{key:"populateInnerTemplate",value:function(){var t=(0,Le.Z)(this.data,this.bodystyle,this.localization,this.isDDTVariant,this.appDamUrlPrefix)({getNode:!0});h.jG.insert(t,this.itemInnerElm)}},{key:"loadAsset",value:function(){this.element.classList.add(Te),this.loadingMessage=(0,v.wi)(this.localization)({getNode:!0}),h.jG.append(this.loadingMessage,this.element),this.pctElm=this.loadingMessage.querySelector(".".concat("specialty-chapter__loading-pct"));var t=this.data.vehicleModel.code.toLowerCase();this.batchLoadAssets=this.batchAssetLoader.loadAssets(["".concat(this.appDamUrlPrefix,"/models/").concat(t,"/images/").concat(t,"-sm.jpg"),"".concat(this.appDamUrlPrefix,"/models/").concat(t,"/images/").concat(t,"-lg.jpg")],h.XK.REQUEST_METHODS.GET)}},{key:"onBatchAssetLoaderProgress",value:function(){this.pctElm.textContent=parseInt(100*this.batchAssetLoader.currentBatchStatus.batchProgress,10)}},{key:"onBatchAssetLoaderComplete",value:function(){this.playoutInnerElmContent()}},{key:"playoutInnerElmContent",value:function(){this.loadingMessage.remove(),this.loadingMessage=null,delete this.loadingMessage,this.element.classList.remove(Te),this.itemInnerElm.addEventListener(c.FP.TRANSITION_END,this.onPlayoutTransitionEnd),this.itemInnerElm.classList.add(Se)}},{key:"onPlayoutTransitionEnd",value:function(){this.itemInnerElm.removeEventListener(c.FP.TRANSITION_END,this.onPlayoutTransitionEnd),h.jG.empty(this.itemInnerElm),this.observer.observe(this.itemInnerElm,this.observerOptions),this.populateInnerTemplate()}},{key:"onDomMutation",value:function(t){this.imageElm=t[0].target.querySelector(".".concat("chapter-models__image")),this.imageElm?(this.imageElm.addEventListener(c.FP.LOAD,this.onImageLoaded),this.imageElm.addEventListener(c.FP.ERROR,this.onImageError)):(this.cacheDOM(),this.playinInnerElmContent()),this.observer.disconnect()}},{key:"onImageLoaded",value:function(){this.imageElm.removeEventListener(c.FP.LOAD,this.onImageLoaded),this.imageElm.removeEventListener(c.FP.ERROR,this.onImageError),this.cacheDOM(),this.playinInnerElmContent()}},{key:"onImageError",value:function(){this.imageElm.removeEventListener(c.FP.LOAD,this.onImageLoaded),this.imageElm.removeEventListener(c.FP.ERROR,this.onImageError),this.cacheDOM(),this.playinInnerElmContent()}},{key:"playinInnerElmContent",value:function(){this.itemInnerElm.addEventListener(c.FP.TRANSITION_END,this.onPlayinTransitionEnd),this.itemInnerElm.classList.remove(Se)}},{key:"onPlayinTransitionEnd",value:function(){this.itemInnerElm.removeEventListener(c.FP.TRANSITION_END,this.onPlayinTransitionEnd),this.HeadingElm.focus(),this.attachEvents(),h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.TRANSITION_COMPLETE,{detail:{element:this.element}}))}},{key:"cacheDOM",value:function(){this.itemInnerElm=this.container.querySelector(".".concat("chapter-models__item-inner")),this.HeadingElm=this.itemInnerElm.querySelector(".".concat("chapter-models__heading")),this.learnMoreElm=this.itemInnerElm.querySelector(".".concat("chapter-models__learn-more")),this.disclaimerElm=this.itemInnerElm.querySelector(".".concat("specialty-page__disclaimer-marker"))}},{key:"attachEvents",value:function(){this.learnMoreElm&&this.learnMoreElm.addEventListener(c.FP.CLICK,this.onLearnMoreClick),this.disclaimerElm.addEventListener(c.FP.CLICK,this.onDisclaimerClick)}},{key:"detachEvents",value:function(){this.learnMoreElm&&this.learnMoreElm.removeEventListener(c.FP.CLICK,this.onLearnMoreClick),this.disclaimerElm.removeEventListener(c.FP.CLICK,this.onDisclaimerClick),this.imageElm&&this.imageElm.removeEventListener(c.FP.LOAD,this.onImageLoaded)}},{key:"update",value:function(t,e){h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.TRANSITION_BEGUN,{detail:{element:this.element}})),this.data=t,this.bodystyle=e,this.detachEvents(),this.loadAsset()}},{key:"onLearnMoreClick",value:function(t){console.log(t)}},{key:"onDisclaimerClick",value:function(t){var e=Pe.Z.chapterCount===this.chapterIndex+1;h.Jw.dispatchEvent(h.Jw.createCustomEvent(c.fD.DOCKED_FOOTER.OPEN_FROM_DISCLAIMER,{detail:{keepFooterButtonVisible:e,currentTarget:t.currentTarget,legend:t.currentTarget.dataset.legend}}))}},{key:"destroy",value:function(){this.observer.disconnect(),this.detachEvents()}}]),t}(),Ae="chapter-models__new-model-button--hidden",Me="chapter-models__tabs-wrapper",De="chapter-models__item-wrapper",Oe="chapterModelsTabs",Ze="chapterModelsItem",xe="chapterModelsNav",we=function(t){function e(){return(0,n.Z)(this,e),(0,o.Z)(this,(0,l.Z)(e).apply(this,arguments))}return(0,r.Z)(e,t),(0,s.Z)(e,[{key:"setBindings",value:function(){this.onAnimElemPlayinComplete=this.onAnimElemPlayinComplete.bind(this),this.onAnimElemPlayoutComplete=this.onAnimElemPlayoutComplete.bind(this),this.onTabClick=this.onTabClick.bind(this),this.onArrowClick=this.onArrowClick.bind(this),this.onSwipeLeft=this.onSwipeLeft.bind(this),this.onSwipeRight=this.onSwipeRight.bind(this),this.onModelNavClick=this.onModelNavClick.bind(this),this.handleInteractiveElems=this.handleInteractiveElems.bind(this),this.onFirstInteractiveElm=this.onFirstInteractiveElm.bind(this),this.onLastInteractiveElm=this.onLastInteractiveElm.bind(this),(0,a.Z)((0,l.Z)(e.prototype),"setBindings",this).call(this)}},{key:"init",value:function(){this.currentTabIndex=0,this.currentModelIndex=0,this.parseDeeplink(),this.totalModelsCount=this.chapterData.data.amgNavData[this.currentTabIndex].modelGroupList.length,this.currentScreenState=h.sp.getState(),this.assetsToLoad=this.collectModelImages(this.chapterData.data.amgNavData),this.batchAssetLoaderMethod=h.XK.REQUEST_METHODS.GET,this.createItem(),this.createTabs(),(0,a.Z)((0,l.Z)(e.prototype),"init",this).call(this)}},{key:"collectModelImages",value:function(t){var e=this,i=[],n=this.currentScreenState.small?"sm":"lg";if(this.chapterData.data.amgNavData.forEach((function(t){var s=t.modelGroupList[0].vehicleModel.code.toLowerCase();i.push("".concat(e.appDamUrlPrefix,"/models/").concat(s,"/images/").concat(s,"-").concat(n,".jpg"))})),0!==this.currentModelIndex){var s=t[this.currentTabIndex].modelGroupList[this.currentModelIndex].vehicleModel.code;i.push("".concat(this.appDamUrlPrefix,"/models/").concat(s.toLowerCase(),"/images/").concat(s.toLowerCase(),"-").concat(n,".jpg"))}return i}},{key:"enterChapterLoadingState",value:function(){this.loadingMessage=(0,ue.Z)(this.localization)({getNode:!0}),this.pctElm=this.loadingMessage.querySelector(".".concat("specialty-chapter__loading-pct")),(0,a.Z)((0,l.Z)(e.prototype),"enterChapterLoadingState",this).call(this)}},{key:"onBatchAssetLoaderProgress",value:function(){this.pctElm.textContent=parseInt(100*this.batchAssetLoader.currentBatchStatus.batchProgress,10)}},{key:"parseDeeplink",value:function(){var t=this,e=document.location.hash.replace("#","").split("|")[1];e&&this.chapterData.data.amgNavData.forEach((function(i,n){i.modelGroupList.forEach((function(i,s){i.vehicleModel.code.toLowerCase()===e&&(t.currentTabIndex=n,t.currentModelIndex=s)}))}))}},{key:"populateTemplate",value:function(){this.element=(0,y.r0)({previous:(this.currentModelIndex-1+this.totalModelsCount)%this.totalModelsCount,next:(this.currentModelIndex+1)%this.totalModelsCount},this.localization)({getNode:!0}),this.tabs.populateTemplate(this.element.querySelector(".".concat(Me))),this.item.populateTemplate(this.element.querySelector(".".concat(De))),(0,a.Z)((0,l.Z)(e.prototype),"populateTemplate",this).call(this)}},{key:"cacheDOM",value:function(){this.tabsWrapperElm=this.element.querySelector(".".concat(Me)),this.itemWrapperElm=this.element.querySelector(".".concat(De)),this.itemElm=this.element.querySelector(".".concat("chapter-models__item")),this.arrowPreviousElm=this.element.querySelector(".".concat("chapter-models__new-model-button--previous")),this.arrowNextElm=this.element.querySelector(".".concat("chapter-models__new-model-button--next")),this.modelsNavElm=this.element.querySelector(".".concat("models-nav-wrapper")),this.item.cacheDOM(),this.tabs.cacheDOM(),this.setArrowVisibility(),(0,a.Z)((0,l.Z)(e.prototype),"cacheDOM",this).call(this)}},{key:"addModelsNavigation",value:function(){var t=[];this.chapterData.data.amgNavData[this.currentTabIndex].modelGroupList.forEach((function(e){t.push(e.vehicleModel.name)})),this.navigation=new I.W_(t,this.modelsNavElm,this.onModelNavClick,{className:"chapter-models__navigation",initialIndex:this.currentModelIndex,transitionLockElement:this.itemElm},this.localization)}},{key:"createItem",value:function(){this.item=new Ie(this.chapterData.data.amgNavData[this.currentTabIndex].modelGroupList[this.currentModelIndex],this.chapterData.data.amgNavData[this.currentTabIndex].bodystyleClassName,this.chapterData.index,this.appDamUrlPrefix,this.localization)}},{key:"createTabs",value:function(){this.tabs=new Ce(this.chapterData.data.amgNavData,this.currentTabIndex,this.onTabClick)}},{key:"registerAnimationElements",value:function(){m.Z.playinFinish=this.onAnimElemPlayinComplete,m.Z.playoutFinish=this.onAnimElemPlayoutComplete,this.animationElements[Oe]=new m.Z(this.element.querySelector(".".concat("chapter-models__tabs-list")),{id:Oe,animationPlayin:de.Z.nothingPlayin,animationPlayout:de.Z.nothingPlayout}),this.animationElements[Ze]=new m.Z(this.itemElm,{id:Ze,animationPlayin:de.Z.nothingPlayin,animationPlayout:de.Z.nothingPlayout}),this.animationElements[xe]=new m.Z(this.modelsNavElm,{id:xe,animationPlayin:de.Z.nothingPlayin,animationPlayout:de.Z.nothingPlayout}),(0,a.Z)((0,l.Z)(e.prototype),"registerAnimationElements",this).call(this)}},{key:"attachEvents",value:function(){this.arrowPreviousElm.addEventListener(c.FP.CLICK,this.onArrowClick),this.arrowNextElm.addEventListener(c.FP.CLICK,this.onArrowClick),h.Xh.isTouch&&(this.swipeContainer=new h.Xh(this.itemWrapperElm),this.swipeContainer.on(h.Xh.EVENTS.SWIPE_LEFT,this.onSwipeLeft),this.swipeContainer.on(h.Xh.EVENTS.SWIPE_RIGHT,this.onSwipeRight)),this.item.attachEvents(),this.tabs.attachEvents(),(0,a.Z)((0,l.Z)(e.prototype),"attachEvents",this).call(this),this.handleInteractiveElems()}},{key:"detachEvents",value:function(){this.arrowPreviousElm.removeEventListener(c.FP.CLICK,this.onArrowClick),this.arrowNextElm.removeEventListener(c.FP.CLICK,this.onArrowClick),this.itemWrapperElm.removeEventListener(c.FP.TOUCHSTART,this.onItemTouchStart),this.element.removeEventListener(c.FP.TOUCHMOVE,this.onItemTouchMove),this.element.removeEventListener(c.FP.TOUCHEND,this.onItemTouchEnd),this.item.detachEvents(),this.tabs.detachEvents(),h.Xh.isTouch&&(this.swipeContainer.off(h.Xh.EVENTS.SWIPE_LEFT,this.onSwipeLeft),this.swipeContainer.off(h.Xh.EVENTS.SWIPE_RIGHT,this.onSwipeRight)),(0,a.Z)((0,l.Z)(e.prototype),"detachEvents",this).call(this)}},{key:"beginPlayin",value:function(){this.addModelsNavigation(),(0,a.Z)((0,l.Z)(e.prototype),"beginPlayin",this).call(this)}},{key:"updateArrowButtons",value:function(){this.arrowPreviousElm.dataset.analyticsTrigger="{'image-carousel':'".concat((this.currentModelIndex-1+this.totalModelsCount)%this.totalModelsCount,"'}"),this.arrowNextElm.dataset.analyticsTrigger="{'image-carousel':'".concat((this.currentModelIndex+1)%this.totalModelsCount,"'}")}},{key:"setArrowVisibility",value:function(){var t=this.totalModelsCount<=1;this.arrowNextElm.classList[t?"add":"remove"](Ae),this.arrowPreviousElm.classList[t?"add":"remove"](Ae)}},{key:"onTabClick",value:function(t){this.currentTabIndex=t,this.currentModelIndex=0;var e=[];this.chapterData.data.amgNavData[t].modelGroupList.forEach((function(t){e.push(t.vehicleModel.name)})),this.totalModelsCount=this.chapterData.data.amgNavData[this.currentTabIndex].modelGroupList.length,this.setArrowVisibility(),this.updateArrowButtons(),this.navigation.updateList(e),this.item.update(this.chapterData.data.amgNavData[t].modelGroupList[this.currentModelIndex],this.chapterData.data.amgNavData[t].bodystyleClassName)}},{key:"onArrowClick",value:function(t){"previous"===t.currentTarget.dataset.direction?this.currentModelIndex=(this.currentModelIndex-1+this.totalModelsCount)%this.totalModelsCount:this.currentModelIndex=(this.currentModelIndex+1)%this.totalModelsCount,this.updateView()}},{key:"onSwipeRight",value:function(){this.currentModelIndex=(this.currentModelIndex+1)%this.totalModelsCount,this.updateView()}},{key:"onSwipeLeft",value:function(){this.currentModelIndex=(this.currentModelIndex-1+this.totalModelsCount)%this.totalModelsCount,this.updateView()}},{key:"updateView",value:function(){this.updateArrowButtons(),this.navigation.updateSelected(this.currentModelIndex),this.item.update(this.chapterData.data.amgNavData[this.currentTabIndex].modelGroupList[this.currentModelIndex],this.chapterData.data.amgNavData[this.currentTabIndex].bodystyleClassName),h.Jw.addEventListener(c.fD.TRANSITION_COMPLETE,this.handleInteractiveElems)}},{key:"handleInteractiveElems",value:function(){var t=this.itemElm.querySelectorAll('button, a, [tabindex]:not([tabindex="-1"])'),e=(0,F.Z)(t).filter((function(t){var e=window.getComputedStyle(t);return"none"!==e.display&&"0"!==e.opacity&&-1!==t.tabIndex&&t})),i=e[e.length-1],n=e[0];i.addEventListener(c.FP.KEYDOWN,this.onLastInteractiveElm),n.addEventListener(c.FP.KEYDOWN,this.onFirstInteractiveElm)}},{key:"onFirstInteractiveElm",value:function(t){t.shiftKey&&9===t.keyCode&&0!==this.currentModelIndex&&(t.preventDefault(),this.currentModelIndex=this.currentModelIndex-1,this.updateView())}},{key:"onLastInteractiveElm",value:function(t){t.shiftKey||9!==t.keyCode||this.currentModelIndex===this.totalModelsCount-1||(t.preventDefault(),this.currentModelIndex=this.currentModelIndex+1,this.updateView())}},{key:"onModelNavClick",value:function(t){this.currentModelIndex=t,this.updateArrowButtons(),this.item.update(this.chapterData.data.amgNavData[this.currentTabIndex].modelGroupList[this.currentModelIndex],this.chapterData.data.amgNavData[this.currentTabIndex].bodystyleClassName)}},{key:"onScreenResize",value:function(t){this.currentScreenState=t}},{key:"destroy",value:function(){this.navigation.destroy(),this.detachEvents(),(0,a.Z)((0,l.Z)(e.prototype),"destroy",this).call(this)}}]),e}(p.Z),Be={AMGChapterIntro:S,AMGSplash:x,AMGEngine:$,AMGPerformance:nt,AMGDesign:Bt,AMGHistory:Wt,AMGGallery:ce,AMGChapterModel:we},Fe=i(11435),_e=function t(){(0,n.Z)(this,t),Fe.Z.registerClasses(Be)}},11435:function(t,e,i){i.d(e,{Z:function(){return u}});var n=i(15671),s=i(43144),o=i(4942),a=i(48218),l=i(61156);function r(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,n)}return i}function h(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?r(Object(i),!0).forEach((function(e){(0,o.Z)(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var c=h({},{BaseChapter:i(82269).Z}),u=function(){function t(e,i){(0,n.Z)(this,t);try{return new c[e](i)}catch(t){return console.error(t),!1}}return(0,s.Z)(t,null,[{key:"registerClasses",value:function(t){c=h({},c,{},t),l.Jw.dispatchEvent(l.Jw.createCustomEvent(a.fD.DATA_LOADED,{detail:{registeredClasses:c}}))}},{key:"classIsRegistered",value:function(t){return!!c[t]}},{key:"classes",get:function(){return c}}]),t}()}}]);
//# sourceMappingURL=c253dc9135ecda0c829b.bundle.js.map